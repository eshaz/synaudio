{"version":3,"names":["global","factory","this","Worker","t","e","n","r","Int32Array","o","s","c","i","length","Uint8Array","map","parseInt","substring","Map","forEach","set","l","a","f","g","h","p","u","DataView","buffer","getInt32","d","charCodeAt","get","m","subarray","console","error","Error","wasmModule","WeakMap","simdWasm","String","raw","scalarWasm","SynAudio","constructor","options","_correlationSampleSize","correlationSampleSize","_initialGranularity","initialGranularity","_correlationThreshold","correlationThreshold","_module","async","WebAssembly","validate","simd","then","simdSupported","compile","SynAudioWorker","module","_sourceCache","_getCorrelationSampleSize","b","Math","min","samplesDecoded","_getInitialGranularity","_setAudioDataOnHeap","input","output","heapPos","bytesPerElement","BYTES_PER_ELEMENT","floatPos","_executeAsWorker","functionName","params","source","isNode","type","webworkerSourceCode","self","onmessage","msg","Promise","resolve","data","_workerMethods","apply","results","postMessage","process","versions","node","Buffer","from","toString","URL","createObjectURL","Blob","worker","globalThis","name","result","message","terminate","_sync","floatByteLength","Float32Array","memory","Memory","initial","channelData","instantiate","env","exports","instanceExports","Object","entries","correlate","dataArray","heapView","aPtr","value","bPtr","bestCorrelationPtr","bestSampleOffsetPtr","correlation","getFloat32","sampleOffset","_syncWorkerConcurrent","threads","promises","lengths","maxThreads","log","max","round","aLength","ceil","offset","aSplit","cutChannel","push","_syncWorker","all","bestResultIdx","bestCorrelation","_syncWorkerConcurrentMain","_instance","clips","workers","graph","notify","wait","runningThreads","vertex","v","vertexClip","edges","Set","edgeClip","edge","syncWorker","correlationResult","add","parent","weighResults","localeCompare","path","cycles","detectCycle","values","has","cycleStartEdge","cycleEndEdge","keep","remove","cycleWith","delete","M","size","roots","traverseRoot","root","sampleOffsetFromRoot","sort","require","define","amd"],"sources":["synaudio.js"],"mappings":"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"}