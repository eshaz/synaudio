/* Copyright 2022 Ethan Halsall. This file is part of synaudio. https://github.com/eshaz/synaudio */
var e,g;e=this,g=function(e){const g=(e,g=4294967295,f=79764919)=>{const b=new Int32Array(256);let t,r,o,i=g;for(t=0;t<256;t++){for(o=t<<24,r=8;r>0;--r)o=2147483648&o?o<<1^f:o<<1;b[t]=o}for(t=0;t<e.length;t++)i=i<<8^b[255&(i>>24^e[t])];return i},f=(e,f=g)=>{const b=e=>new Uint8Array(e.length/2).map((g,f)=>parseInt(e.substring(2*f,2*(f+1)),16)),t=e=>b(e)[0],r=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((e,g)=>r.set(e,g));const o=new Uint8Array(e.length);let i,s,p,h=!1,n=0,P=42,y=e.length>13&&"dynEncode"===e.substring(0,9),a=0;y&&(a=11,s=t(e.substring(9,a)),s<=1&&(a+=2,P=t(e.substring(11,a))),1===s&&(a+=8,p=(e=>new DataView(b(e).buffer).getInt32(0,!0))(e.substring(13,a))));const u=256-P;for(let g=a;g<e.length;g++)if(i=e.charCodeAt(g),61!==i||h){if(92===i&&g<e.length-5&&y){const f=e.charCodeAt(g+1);117!==f&&85!==f||(i=parseInt(e.substring(g+2,g+6),16),g+=5)}if(i>255){const e=r.get(i);e&&(i=e+127)}h&&(h=!1,i-=64),o[n++]=i<P&&i>0?i+u:i-P}else h=!0;const c=o.subarray(0,n);if(y&&1===s){const e=f(c);if(e!==p){const g="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",g+"\n","Expected: "+p+"; Got: "+e+"\n","Visit https://github.com/eshaz/simple-yenc for more information"),Error(g)}}return c},b=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),t=new WeakMap,r=new WeakMap,o=String.raw`dynEncode01651718049eeÆØÒfeeefsfÅoääääääääääegtfhÊÓÛkÒÊÒÔ×Þgeghgfekmfäe¦åíiplgnÈÔ××ÊÑÆÙÊeepÄÄÍÊÆÕÄÇÆØÊheofitämâlàmág¥¦cdddl}©eeeeeeU¤©eeeeeeeepg¥g¥g¦g­reg¦fÐzf¦v³i¥ff¦vÐp¦ÕÖg¦vÏofo¯o¦hÖxgx×oÐ¦uÏsp¦iÛr¦kÙeÏqo¦gÙp¦gÙ¦¥ÖÐÏyf¦gÙ{r¦fÏuq¦¥ÐpogÐ¦uÐo¦l°|g¦uÏqoxÐÏvh¥egurh¥ggtÏobeeegbeeebIfbpeegobeeugbeeubIfbpeugobeegbeebIfbpegobeegbeebIfbpeg¦¥Ðgr¦fÐrrepg¥fq±reqog¥|ªrepyw{ÑgÏ®ygpÏ°Örepgsoh¥ggbegegtÏbegebIfbpgeg¦uÏgo¦iÏorepvoxªrfpo¦gÙeÏgh¥gggegtÏge÷geg¦iÏgfo¦fÏo¯reppt{Ïtw¦fÏwz¬repqfpf¦e±reeef¦gÙyÏ®iäefg¦gÙ¦iÐÑeÏ®j¦epf¦i®×{f¦hÖse¦Ïue¦Ïve¦uÏxf¦adddlÖqh¥¦epg¥{ªi¥eebegeefwÑ¦gÙgÏbegebIfbpgeg¥q¦i«rexxbegegxÏbegebIfbpgeq¦m«revvbegegvÏbegebIfbpgeq¦q«reuubegeguÏbegebIfbpgepfqp«rfpptsi¥psÏtp¦gÙeÏgsoh¥gggegrÏge÷geg¦iÏgo¦fÐorepppfÐ¦á°reftÐpt¦gÙeÏgh¥gggegrÏoge÷gegggiogi÷gigggmogm÷gmgggqogq÷gqg¦uÏgp¦iÐpreppryÏrw¦fÏwz¬reppg¥j¦g­rej¦fÐxi¦v³i¥ii¦vÐj¦ÕÖg¦vÏoio¯o¦hÖvgv×oÐ¦uÏqj¦iÛp¦kÙhÏro¦gÙj¦gÙ¦¥ÖÐÏzi¦gÙyp¦fÏsr¦¥Ðj¦etogÐ¦uÐo¦l°{g¦uÏpovÐÏu¦ewh¥hgsrh¥ggtÏobeeegbeeebIfbpeegobeeugbeeubIfbpeugobeegbeebIfbpegobeegbeebIfbpeg¦¥Ðgr¦fÐrrepg¥ip±repog¥{ªrejzwyÑgÏ®zgjÏ°Örejgqoh¥ggbegegtÏbegebIfbpgeg¦uÏgo¦iÏorepuovªrfpo¦gÙhÏgh¥gggegtÏge÷geg¦iÏgio¦fÏo¯repptyÏtw¦fÏwx¬repqfpi¦e±rehhi¦gÙzÏ®iähij¦gÙ¦iÐÑhÏ®j¦epi¦i®×yi¦hÖqh¦Ïsh¦Ïuh¦uÏvi¦adddlÖj¦er¦ewh¥¦epg¥yªi¥hhbegehiwÑ¦gÙgÏbegebIfbpgeg¥j¦i«revvbegegvÏbegebIfbpgej¦m«reuubegeguÏbegebIfbpgej¦q«ressbegegsÏbegebIfbpgepijp«rfpptqi¥pqÏtp¦gÙhÏgqoh¥gggegrÏge÷geg¦iÏgo¦fÐorepppiÐ¦á°reitÐpt¦gÙhÏgh¥gggegrÏoge÷gegggiogi÷gigggmogm÷gmgggqogq÷gqg¦uÏgp¦iÐprepprzÏrw¦fÏwx¬repp¦eqn¦egem¦egegäk¦e¯i¥g¥g¥g¥g¥k¦f«i¥¦erqfpegk}Öroh¥gbÂgebÄbUfg¦mÏgo¦gÐorepbrmnopqrstefghijklbUfbekr«rfpkrÐor¦gÙeÏgh¥gge g¦iÏgo¦fÐorepk¦f«i¥¦erqgpk}Örpbqeeeeeeeeeeeeeeeehgroh¥gbÂgebÄbUfg¦mÏgo¦gÐorepbrmnopqrstefghijklbUfbekr«rfpkrÐor¦gÙhÏgh¥gge g¦iÏgo¦fÐoreppk¦uÐik~k¦v­i¥bqeeeeeeeeeeeeeeee¦eqgp~bx¦eobqeeeeeeeeeeeeeeeehgh¥gbeeebJfbKfbIfgbeeubJfbKfbIfgbeebJfbKfbIfgbeebJfbKfbIfg¦¥Ðgio¦uÏo¯rep¦fqk¦vÐ¦ÕÖ¦uÏqfpk¦uÐik¦epjbebf÷bg÷bh÷g¥jk³rekkjÐp¦i´iäbqeeeeeeeeeeeeeeeebej¦gÙhÏg~bxp¦áÖroh¥gbegebJfbKfbIfg¦uÏgo¦iÐorepbrmnopqrstefghefghbIfbrijklefghefghefghbIfbepr«rfjrÏjjpjÐoj¦gÙhÏgh¥gge~øù÷g¦iÏgo¦fÐoreppk¨eeå$÷¦eoqi¥~bxhgh¥ggbeeebJfbpeeggbeeubJfbpeuggbeebJfbpeggbeebJfbpeg¦¥Ðgio¦uÏo¯reppúfkÐsg¥ko±rekkoÐf¦h°iäo¦gÙhÏg~bxf¦áÖjrh¥ggbegebJfbpgeg¦uÏgr¦iÐrrepfj«rfjoÏjopoÐro¦gÙhÏgh¥ggge~øgeg¦iÏgr¦fÐrreppös¦e¯i¥l¦gÙv¨eeå¤úk¦vÐ¦ÕÖ¦uÏrmge ¦efeph¥f¦gÙeÏwge~gäqªi¥bqeeeeeeeeeeeeeeeebqeeeeeeeeeeeeeeee¦eqfpbx¦eg¦etbqeeeeeeeeeeeeeeeebqeeeeeeeeeeeeeeeeh¥gpÏjbeeebJfghÏobeeebKfbIfjbeeubJfobeeubKfbIfjbeebJfobeebKfbIfjbeebJfobeebKfbIfbKfbIfbKfbIfbKfbIfbKfbIfg¦¥Ðgit¦uÏt¯reprpj~ bebf÷bg÷bh÷~bebf÷bg÷bh÷g¥jk³rekjÐt¦i´iäj¦gÙgbqeeeeeeeeeeeeeeeebebqeeeeeeeeeeeeeeee~bebxt¦áÖuoh¥gpÏbegebJfghÏbegebKfbIfg¦uÏgbKfbIfo¦iÐorepbrmnopqrstefghefghbIfbrijklefghefghefghbIfbebrmnopqrstefghefghbIfbrijklefghefghefghbIfbe~tu«rfjuÏjjpj¦gÙgkjÐoh¥gpÏgeøghÏgeù÷g¦iÏgù~÷~o¦fÐoreppk¦gÙwÏge ù ~ù ~Åªiânfgem~ge~jppvÏpflÏfs­reppg¥l¦f±rengefllÑgÏjsjs­l¦erfgÐf¦ef¦e¯tg¥k¦e±i¥qfpk¦f¬i¥t¦gÙeÏgbqeeeeeeeeeeeeeeeek}Öroh¥gbÂgebÄbUfg¦mÏgo¦gÐorepbrmnopqrstefghijklbUfbekr«rfpr¦gÙt¦gÙÏeÏgkrÐoh¥gge g¦iÏgo¦fÐorepplt±re¨eeå¤út¦gÙeÏpk¦vÐ¦ÕÖ¦uÏjmge h¥t¦gÙeÏuge~gäqªi¥bqeeeeeeeeeeeeeeeebqeeeeeeeeeeeeeeee¦eqfpbx¦erpghobqeeeeeeeeeeeeeeeebqeeeeeeeeeeeeeeeeh¥gbeeebJfobeeebKfbIfgbeeubJfobeeubKfbIfgbeebJfobeebKfbIfgbeebJfobeebKfbIfbKfbIfbKfbIfbKfbIfbKfbIfg¦¥Ðgo¦¥Ðoir¦uÏr¯repjpf~ bebf÷bg÷bh÷~bebf÷bg÷bh÷g¥fk³rekfÐr¦i´iäf¦gÙgbqeeeeeeeeeeeeeeeebebqeeeeeeeeeeeeeeee~bebxr¦áÖsoh¥gpÏbegebJfghÏbegebKfbIfg¦uÏgbKfbIfo¦iÐorepbrmnopqrstefghefghbIfbrijklefghefghefghbIfbebrmnopqrstefghefghbIfbrijklefghefghefghbIfbe~rs«rffsÏjfpf¦gÙgkfÐoh¥gpÏgeøghÏgeù÷g¦iÏgù~÷~o¦fÐoreppk¦gÙuÏge ù ~ù ~Åªiântgem~ge~jpp¦iÏpt¦fÏtl¬reppppe°tÙÆ×ÌÊÙÄËÊÆÙÚ×ÊØjlÆÙÔÒÎÈØtÒÚÙÆÇÑÊÌÑÔÇÆÑØlØÎÒÉpÇÚÑÐÒÊÒÔ×ÞmØÎÌÓÊÝÙ`,i=String.raw`dynEncode010fff699321p|,ooot}|t|~P*r~t{ptnnwtpnqptÿ ¡O/PW/Pz0/P]O/Pz0/P0/Py10O/0/0/0P0O//9//y19¡G//9/9¡G//9/9¡G//9/9¡G/1Py0/1Py0/Py0//Py1Y//YOO//9/9¡G/Py0/Py0//Py1Y//y0//y0/Py1/V/P[/P0/90/PU0/PU0/0O///9¡1GO///9/9¡G/PU//9/9¡G///9/9¡G//y0/Pz1O/1PWP/Pz0/Pz0O//y19/¢1//y19£/¡/9/¢1/9£¡/9/¢1/9£¡/9/¢1/9£¡0//£/¡//£¡//£¡//£¡0/Py0//Py1Y/PPy1/]//zP//P1y9/¢1//y9£/¡0//£/¡0/Py/0/Pz/U//z0//P1y0//y0O/9/¢1/£/9/¢1/£/¡¡0//9£//9£/¡¡0/Py0/Py0/Pz1//ÁRÎ¡1¤Ê//¤Ê®/Ê±²ÅàOP0SÿN0&S0'O///////PE/PE/PYO/P0/Pz1P^O/0//10O/!/9Ê¯/9Ê¯/9Ê¯/9Ê¯0!/Py0/Pz1/O/P/y0/0O/!/9Ê¯0!/Py0/Pz1/P^O/0//10O/"/9Ê¯/9Ê¯/9Ê¯/9Ê¯0"/Py0/Pz1/O/P/y0O/"/9Ê¯0"/Py0/Pz1/Pz0/Á0 /PWOP0P/"Å/ ¤0P0/0O/9/¢1/£/¡/9/¢1/£¡/9/¢1/£¡/9/¢1/£¡0/Py0/Py1/WP0/PzPPy/Pz0/Á0 P0/"/Æ1"²Å0O//]//zP1/P/y0/0O/9/¢1/£/¡0/Py0/Pz1//y/0//zPZ//z0/P/y0O/9/¢1/£/9/¢1/£/9/¢1/£/9/¢1/£/¡¡¡¡0/Py0/Pz1/ RÎ¡0 P0/O/0O//9/¢G//9/¢G//9/¢G//9/¢G/Py0/Py1/W// ¤0//z0O//]/0//zP1O//y0/P/y0O//9/¢G/Py0/Pz1//zPZ//z0/P/y0O//9/¢G//9/¢G//9/¢G//9/¢G/Py0/Pz1/ 0O/P[OP0/P0/P0/&/"²0#P0/0P0O/!/9Ê°0$//y9Ê0%/90///!/#±Å//1 /nT//E// G//0/$/%¯0!//y0//y1/WO/P[///{1y1///W*0P0//z1P/PY*0O/P[O/'0!/P0O/PzPXO/'0!/P/y0/'0!//10O/!/9Ê¯/9Ê¯/9Ê¯/9Ê¯0!/Py0/Pz1/T/P/Py/y0O/!/9Ê¯0!/Py0/Pz1//]/P0/&/"²0"/P/y0O/!/9Ê°0#//y9Ê0$/90///!/"±Å//1 /nTO//E// G/#/$¯0!/Py0/Py1/V;pvtnutpt:|pq{t<v{~qp{:xv}<t`;class s{constructor(g={}){this.t=g.correlationSampleSize>0?g.correlationSampleSize:11025,this.o=g.initialGranularity>0?g.initialGranularity:16,this.i=g.p>=0?g.p:.5,this.h=t.get(s),this.h||(this.h=b().then(e=>e?WebAssembly.compile(f(o)):WebAssembly.compile(f(i))),t.set(this.h)),this.P=r.get(s),this.P||(this.P=b().then(e=>66560),r.set(this.P)),this.u=function g(f,b,t,r){this.l=new Map,this.m=(e,g)=>Math.min(e.samplesDecoded,g.samplesDecoded,this.t),this.q=(e,g)=>Math.min(e.samplesDecoded,g.samplesDecoded,this.o),this.j=(e,g,f)=>{const b=g.BYTES_PER_ELEMENT;let t=f/b;for(let r=0;r<e.length;r++)f+=e[r].length*b,g.set(e[r],t),t+=e[r].length;return f},this.k=(f,b)=>{let t=this.l.get(f);if(!t){let e,b="text/javascript",r=`'use strict';(${""+((e,g,f,b)=>{self.onmessage=t=>{new e(Promise.resolve(t.data.module),Promise.resolve(t.data.O),f,b).I.get(g).apply(null,t.data.v).then(e=>{self.postMessage(e)})}})})(${""+g}, "${f}", ${this.t}, ${this.o})`;try{e=void 0!==process.versions.node}catch{}t=e?`data:${b};base64,${Buffer.from(r).toString("base64")}`:URL.createObjectURL(new Blob([r],{type:b})),this.l.set(f,t)}const r=new(globalThis.Worker||e)(t,{name:"SynAudio"}),o=new Promise(e=>{r.onmessage=g=>{r.terminate(),e(g.data)}});return Promise.all([this.h,this.P]).then(([e,g])=>{r.postMessage({module:e,O:g,v:b})}),o},this.K=(e,g,f,b,t,r,o,i,s,p,h)=>this.h.then(g=>WebAssembly.instantiate(g,{env:{memory:e}})).then(({exports:n})=>{const P=new Map(Object.entries(n)).get("correlate"),y=new DataView(e.buffer);return P(g,f,b,t,r,o,i,s,p,h),{correlation:y.getFloat32(p,!0),sampleOffset:y.getInt32(h,!0)}}),this.M=(e,g)=>this.P.then(f=>{const b=Float32Array.BYTES_PER_ELEMENT,t=(e.samplesDecoded*e.channelData.length*b+g.samplesDecoded*g.channelData.length*b+2*b+f)/65536+4,r=new WebAssembly.Memory({initial:t,W:t,G:!0}),o=new Float32Array(r.buffer),i=f,s=this.j(e.channelData,o,i),p=this.j(g.channelData,o,s),h=p+b,n=this.m(e,g),P=this.q(e,g);return this.K(r,i,e.samplesDecoded,e.channelData.length,s,g.samplesDecoded,g.channelData.length,n,P,p,h)}),this.J=(e,g,f=1,b=()=>{})=>this.P.then(t=>{const r=Float32Array.BYTES_PER_ELEMENT,o=(e.samplesDecoded*e.channelData.length*r+g.reduce((e,g)=>g.samplesDecoded*g.channelData.length*r+e,0)+g.length*(2*r)+t)/65536+4,i=new WebAssembly.Memory({initial:o,W:o,G:!0}),s=new Float32Array(i.buffer),p=t;let h=this.j(e.channelData,s,p);const n=g.map(g=>{const f=this.j(g.channelData,s,h),b=f+r,t=b+r,o=this.m(e,g),n=this.q(e,g),P=[i,p,e.samplesDecoded,e.channelData.length,h,g.samplesDecoded,g.channelData.length,o,n,f,b];return h=t,P});let P=0,y=0,a=0;const u=Array(n.length);return new Promise((e,g)=>{b(0);const t=()=>{if(P>=n.length)return void(0===y&&e(u));const r=P++;y++,this.k("_syncWasmMemory",n[r]).then(e=>{u[r]=e}).catch(g).finally(()=>{y--,a++,b(a/u.length),t()}),y<f&&t()};t()})}),this.A=(e,g,f)=>{const b=[],t=[0],r=this.m(e,g),o=Math.log(e.samplesDecoded*r)/Math.log(this.o+1)*Math.log(r/1e4+1);f=Math.max(Math.round(Math.min(f,o,e.samplesDecoded/r/4)),1);const i=Math.ceil(e.samplesDecoded/f);let s=0;for(let p=0;p<f;p++){const f={channelData:[]};for(let g=0;g<e.channelData.length;g++){const b=e.channelData[g].subarray(s,s+i+r);f.channelData.push(b),f.samplesDecoded=b.length}s+=i-r,t.push(s),b.push(this.U(f,g))}return Promise.all(b).then(e=>{let g=0,f=-1;for(let b=0;b<e.length;b++)e[b].correlation>f&&(g=b,f=e[b].correlation);return{correlation:e[g].correlation,sampleOffset:e[g].sampleOffset+t[g]}})},this.U=(e,g)=>this.k("_sync",[e,g]),this.$=(e,g,f)=>globalThis.Worker?this.k("_syncWorkerConcurrent",[e,g,f]):this.A(e,g,f),this.I=new Map([["_sync",this.M],["_syncWasmMemory",this.K],["_syncOneToMany",this.J],["_syncWorker",this.U],["_syncWorkerConcurrent",this.A]]),this.h=f,this.P=b,this.t=t,this.o=r},this.S=new this.u(this.h,this.P,this.t,this.o)}async syncWorkerConcurrent(e,g,f){return this.S.$(e,g,f>=1?f:1)}async syncWorker(e,g){return this.S.U(e,g)}async sync(e,g){return this.S.M(e,g)}async T(e,g,f,b){return this.S.J(e,g,f,b)}async syncMultiple(e,g){g=g>=1?g:8;const f=[],b=[];let t=()=>{},r=Promise.resolve(),o=0;const i=()=>{r=new Promise(e=>{t=e})};for(let u=0;u<e.length;u++)b.push({vertex:{}});for(let u=0;u<e.length;u++){const s=e[u],p=b[u].vertex;p.name=s.name,p.samplesDecoded=s.data.samplesDecoded,p._=new Set;for(let h=0;h<e.length;h++){if(u===h)continue;const n=e[h],P=b[h];o++,f.push(this.syncWorker(s.data,n.data).then(e=>{e.correlation>this.i&&p._.add({parent:p,vertex:P.vertex,samplesDecoded:n.data.samplesDecoded,...e}),o--,t()})),o>=g&&(i(),await r)}}await Promise.all(f);const s=(e,g)=>e.parent&&g.parent&&e.parent.samplesDecoded!==g.parent.samplesDecoded?e.parent.samplesDecoded>g.parent.samplesDecoded:e.correlation!==g.correlation?e.correlation>g.correlation:e.sampleOffset!==g.sampleOffset?e.sampleOffset>g.sampleOffset:e.vertex&&g.vertex&&e.vertex.name.localeCompare(g.vertex.name)<0,p=new Map,h=new Set,n=e=>{for(const g of e._.values()){if(p.has(e))return p.get(e);p.set(e,g);const f=n(g.vertex),b=g;if(f){let e,g;s(f,b)?(e=f,g=b):(e=b,g=f),g.Y||(g.Y=new Set,h.add(g)),g.Y.add(e),e.Y&&e.Y.delete(g)}p.delete(e)}};for(const{vertex:u}of b)n(u);for(const u of h)u.Y.size&&u.parent._.delete(u);const P=new Set;for(const u of b)P.add(u.vertex);for(const u of b)for(const e of u.vertex._)P.delete(e.vertex);const y=(e,g,f,b=0)=>{for(const t of f)e.has(t.vertex)&&s(e.get(t.vertex),t)||e.set(t.vertex,{name:t.vertex.name,correlation:t.correlation,sampleOffset:b+t.sampleOffset}),y(e,g,t.vertex._,b+t.sampleOffset)},a=[];for(const u of P){const e=new Map;e.set(u,{name:u.name,sampleOffset:0}),y(e,u,u._),a.push([...e.values()].sort((e,g)=>e.sampleOffset-g.sampleOffset||(e.correlation||0)-(g.correlation||0)||g.name.localeCompare(e.name)))}return a}}return s},"object"==typeof exports&&"undefined"!=typeof module?module.exports=g(require("@eshaz/web-worker")):"function"==typeof define&&define.amd?define(["@eshaz/web-worker"],g):(e="undefined"!=typeof globalThis?globalThis:e||self).SynAudio=g(e.Worker);
//# sourceMappingURL=synaudio.min.js.map