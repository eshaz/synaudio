/* Copyright 2022 Ethan Halsall. This file is part of synaudio. https://github.com/eshaz/synaudio */
var O,x;O=this,x=function(O){const x=(O,x=4294967295,t=79764919)=>{const s=new Int32Array(256);let y,e,N,n=x;for(y=0;y<256;y++){for(N=y<<24,e=8;e>0;--e)N=2147483648&N?N<<1^t:N<<1;s[y]=N}for(y=0;y<O.length;y++)n=n<<8^s[255&(n>>24^O[y])];return n},t=(O,t=x)=>{const s=O=>new Uint8Array(O.length/2).map((x,t)=>parseInt(O.substring(2*t,2*(t+1)),16)),y=O=>s(O)[0],e=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((O,x)=>e.set(O,x));const N=new Uint8Array(O.length);let n,i,o,r=!1,h=0,c=42,a=O.length>13&&"dynEncode"===O.substring(0,9),l=0;a&&(l=11,i=y(O.substring(9,l)),i<=1&&(l+=2,c=y(O.substring(11,l))),1===i&&(l+=8,o=(O=>new DataView(s(O).buffer).getInt32(0,!0))(O.substring(13,l))));const f=256-c;for(let x=l;x<O.length;x++)if(n=O.charCodeAt(x),61!==n||r){if(92===n&&x<O.length-5&&a){const t=O.charCodeAt(x+1);117!==t&&85!==t||(n=parseInt(O.substring(x+2,x+6),16),x+=5)}if(n>255){const O=e.get(n);O&&(n=O+127)}r&&(r=!1,n-=64),N[h++]=n<c&&n>0?n+f:n-c}else r=!0;const m=N.subarray(0,h);if(a&&1===i){const O=t(m);if(O!==o){const x="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",x+"\n","Expected: "+o+"; Got: "+O+"\n","Visit https://github.com/eshaz/simple-yenc for more information"),Error(x)}}return m},s=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),y=new WeakMap,e=new WeakMap,N=String.raw`dynEncode010e324cc972o{ns|{s{}O)q}szosmmvso~mposó2ð2NRþM/;R/<NN.Oy0%S.OUN..Oy0O~0Ox0..Y)0O0#..yOx/.O.OONy..O0Ox0x/$.O/!.Ox/.ONy/..yOy0OY/".Ox0..#yx/N././N...x0.ò...ò.....ò...>.>ò>.ONy/.Oy0N..[./N."S.. .!z0x.$W..$x.Y././N....xò.Ox/.Ox0./.#S..Ox/N..8..x8 F.Ox/..Ox0Y..!x/. Ox0 .%U.ONy.Y..OOy.zx.YO/.O/.O>x/.O.x/.Ox/N././N.SN..... zO0xò....xò....xò....xòN..8..x08 F..8.8 F..8.8 F..8.8 F.Ox/.Oy0..x/. Ox0 .%UN.Oy0$S.OUN..Oy0O~0Ox0..W)0O/#..#.yOx/.O.OONy..O0Ox0x/!.O/".Ox/.ONy/O/..yOy0OY/.Ox0..#yx/O/ N././N...x0.ò...ò.....ò...>.>ò>.ONy/.Oy0N..[./N.S.. ."z0x.!W..!x.Y././N....xò.Ox/.Ox0./.#S..Ox/N..8..x8 F.Ox/..Ox0Y.."x/. Ox0 .$U.ONy.Y..OOy.zx.YO/.O/.O>x/.O.x/.Ox/O/O/ N././N.SN..... zO0xò....xò....xò....xòN..8..x08 F..8.8 F..8.8 F..8.8 F.Ox/.Oy0..x/. Ox0 .$UO/.OD.ODN.SNO~/NNN.OUN./.O0/N...kmþ/..Ox/.Oy0......þ//5..T..y/..Ox/N.5.8É®/5.Ox/.Oy0.OTNO/.O//.././N...kmþ/..Ox/.Oy0......þ//7..T..y/..Ox/N.7.8É®/7.Ox/.Oy0.7.Æ07±Ä/'.Oy0/.O/O/!O.'!/1O//../N..1ó0/./ô..ò..1ó0/./ôò...1ó0/./ôò.>.1ó0/./ôò/..ONy/..Ox0YO/!.OyO~Ox/..-..- ..- ..- /(N..]...y0O].(./...Ox/.'!/1.O0/N..1ó0/./ô..ò/..Ox/.Oy0......ò0/././ò-/(..T..x.0y/..Ox/N.8.'¡0&.&¢.( /(.Ox/.Oy0.ÁQÍ /,O/.!SN.'!//./N.../ó.../ó..../ó...>./ó>.ONy/..Ox0Y.(.,£/&N..[...y0OY..Ox/.'!//.O0/N.../ó.Ox/.Oy0..T..x.0y/..Ox/N..8.'¡F.Ox/.Oy0..y/".&/*..UN.O/.;.7±/8QM.,£/+.OyO~Ox/.8/'.*É/9O/./N..Ox08/&.5.8°Ä/-.!N/./0O.-!/2O/O//0/.N..x0.2ó03..x0ô.0ò..2ó04.ôò...2ó01..ôò.>.2ó0/.>ôò/0.3.3ô..ò.4.4ôò.1.1ôò././ôò/..ONy/..Ox0Y./.&É/6..-..- ..- ..- /(.0-.0- .0- .0- /)N..0[..y0O].O/.)./..(./0.-!//.O0/N..x./ó01..xô..ò/..Ox/.1.1ô.0ò/0.Oy0.....1ò0/././ò-/).0.0./ò0/././ò-/(..T..x.0O/..y/N..x8.-¡0&..x8¢.) /).Ox/.&.&¢.( /(.Oy0..Ox8É/:.5.6¯/6.'.).+¢É.(.+¢É­.9°±Ä0&nS..D..&F.&.'/'.6.:®/5..x/..x0."WN.O[.60..z0x0.".."W)/..y/N.SN.</5N.OTN.</5O/..Ox//..O0/N...kmþ/..Ox/.Oy0......þ//5..T..O.Ox.Oyx/..y/N.5.8É®/5.Ox/.Oy0..[..O.Oyx/.;.7±/8QM.,£/+.OyO~Ox/.8/'.*É/9N..Ox08/&.5.8°Ä/*.!N/./0O.*!/2O/././/0/.N..2ó03.ô.0ò..2ó04.ôò...2ó01..ôò.>.2ó0/.>ôò/0.3.3ô..ò.4.4ôò.1.1ôò././ôò/..ONy/.ONy/..Ox0Y./.&É/6..-..- ..- ..- /(.0-.0- .0- .0- /)N..]..y0O].O/.)./..(./0.*!//.O0/N..x./ó01..xô..ò/..Ox/.1.1ô.0ò/0.Oy0.....1ò0/././ò-/).0.0./ò0/././ò-/(..T..x.0O/..y/N..x8.*¡0&..x8¢.) /).Ox/.&.&¢.( /(.Oy0..Ox8É/:.5.6¯/6.'.).+¢É.(.+¢É­.9°±Ä0&nS..D..&F.&.'/'.6.:®/5.Ox/.Ox0.U`,n=String.raw`dynEncode010e26c673ddo{+nnns|{s{}O)q}szosmmvso~mposàN.Oy0S.Oy0N.O/.Ox0/N./././O/N..8..x08 F..8.8 F..8.8 F..8.8 F.0Ox/.0Ox/.Ox/..Ox0Y..YNN..8.8 F.Ox/.Ox/..Ox0Y..x/..x/.Ox0.U.O/.8/.OT/.OT/./N...8 0FN...8.8 F.OT..8.8 F...8.8 F..x/.Oy0N.0Oy0.Oy/N..x08.¡0..x08¢. .8.¡0.8¢ .8.¡0.8¢ .8.¡0.8¢ /..¢. ..¢ ..¢ ..¢ /.Ox/..Ox0Y.OOxO0.]..yO..O0x8.¡0..x8¢. /..¢. /.Ox./.Oy.T..y/..O0x/..x/N.8.¡0.¢.8.¡0.¢.  /..8¢..8¢.  /.Ox/.Ox/.Oy0..ÁQÍ 0£É..£É­.É°±ÄÖNRþM/%R/&N.......OD.ODN.SNO/Q.O/.Oy0O]N./.O0/N. .8É®.8É®.8É®.8É®/ .Ox/.Oy0.N.O.x/./N. .8É®/ .Ox/.Oy0N.OWNO/./.O0/N.!.8É®.8É®.8É®.8É®/!.Ox/.Oy0.N.O.x/N.!.8É®/!.Ox/.Oy0.Á/.Oy0S.!Ä.£/O/./N.8.¡0.¢. .8.¡0.¢ .8.¡0.¢ .8.¡0.¢ /.Ox/..Ox0Y.OyOOx/OO/O/O/.!.Æ0$±Ä/N..[..yO0.O.x/./N.8.¡0.¢. /.Ox/.Oy0..x./..yOY..y/.O.x/N.8.¡0.¢.8.¡0.¢.8.¡0.¢.8.¡0.¢.    /.Ox/.Oy0.QÍ /O/.SN./N..8.¡F..8.¡F..8.¡F..8.¡F.Ox/..Ox0Y..£/N..]./..yO0N..x/.O.x/N..8.¡F.Ox/.Oy0..yOY..y/.O.x/N..8.¡F..8.¡F..8.¡F..8.¡F.Ox/.Oy0..y/./O/..UN.O/.O/.%.$±/"./O/N. .8É¯/#..x8É/!.8/... ."°Ä..0.mS..D..F../.#.!®/ ..x/..x0.WN.O[...z0x0...W)/..y/N.SN.&/ .O/N.OyOWN.&/ O/.O.x/.&/ .O0/N. .8É®.8É®.8É®.8É®/ .Ox/.Oy0.S.O.Ox.Oy.x/N. .8É®/ .Ox/.Oy0..].O.Oy.x/.O/.%.$±/"N. .8É¯/#..x8É/!.8/... ."°Ä..0.mSN..D..F.#.!®/ .Ox/.Ox0.U`,i=String.raw`dynEncode010e1a4ff503o{n s|{s{}O)q}szosmmvso~mposó2ð2NRþM/;R/<NN.Oy0%S.OUN..Oy0O~0Ox0..Y)0O0#..yOx/.O.OONy..O0Ox0x/$.O/!.Ox/.ONy/..yOy0OY/".Ox0..#yx/N././N...x0.ò...ò.....ò...>.>ò>.ONy/.Oy0N..[./N."S.. .!z0x.$W..$x.Y././N....xò.Ox/.Ox0./.#S..Ox/N..8..x8 F.Ox/..Ox0Y..!x/. Ox0 .%U.ONy.Y..OOy.zx.YO/.O/.O>x/.O.x/.Ox/N././N.SN..... zO0xò....xò....xò....xòN..8..x08 F..8.8 F..8.8 F..8.8 F.Ox/.Oy0..x/. Ox0 .%UN.Oy0$S.OUN..Oy0O~0Ox0..W)0O/#..#.yOx/.O.OONy..O0Ox0x/!.O/".Ox/.ONy/O/..yOy0OY/.Ox0..#yx/O/ N././N...x0.ò...ò.....ò...>.>ò>.ONy/.Oy0N..[./N.S.. ."z0x.!W..!x.Y././N....xò.Ox/.Ox0./.#S..Ox/N..8..x8 F.Ox/..Ox0Y.."x/. Ox0 .$U.ONy.Y..OOy.zx.YO/.O/.O>x/.O.x/.Ox/O/O/ N././N.SN..... zO0xò....xò....xò....xòN..8..x08 F..8.8 F..8.8 F..8.8 F.Ox/.Oy0..x/. Ox0 .$UO/.OD.ODN.SNO~/NNN.OUN./.O0/N...kmþ/..Ox/.Oy0......þ//5..T..y/..Ox/N.5.8É®/5.Ox/.Oy0.OTNO/.O//.././N...kmþ/..Ox/.Oy0......þ//7..T..y/..Ox/N.7.8É®/7.Ox/.Oy0.7.Æ07±Ä/'.Oy0/.O/O/!O.'!/1O//../N..1ó0/./ô..ò..1ó0/./ôò...1ó0/./ôò.>.1ó0/./ôò/..ONy/..Ox0YO/!.OyO~Ox/..-..- ..- ..- /(N..]...y0O].(./...Ox/.'!/1.O0/N..1ó0/./ô..ò/..Ox/.Oy0......ò0/././ò-/(..T..x.0y/..Ox/N.8.'¡0&.&¢.( /(.Ox/.Oy0.ÁQÍ /,O/.!SN.'!//./N.../ó.../ó..../ó...>./ó>.ONy/..Ox0Y.(.,£/&N..[...y0OY..Ox/.'!//.O0/N.../ó.Ox/.Oy0..T..x.0y/..Ox/N..8.'¡F.Ox/.Oy0..y/".&/*..UN.O/.;.7±/8QM.,£/+.OyO~Ox/.8/'.*É/9O/./N..Ox08/&.5.8°Ä/-.!N/./0O.-!/2O/O//0/.N..x0.2ó03..x0ô.0ò..2ó04.ôò...2ó01..ôò.>.2ó0/.>ôò/0.3.3ô..ò.4.4ôò.1.1ôò././ôò/..ONy/..Ox0Y./.&É/6..-..- ..- ..- /(.0-.0- .0- .0- /)N..0[..y0O].O/.)./..(./0.-!//.O0/N..x./ó01..xô..ò/..Ox/.1.1ô.0ò/0.Oy0.....1ò0/././ò-/).0.0./ò0/././ò-/(..T..x.0O/..y/N..x8.-¡0&..x8¢.) /).Ox/.&.&¢.( /(.Oy0..Ox8É/:.5.6¯/6.'.).+¢É.(.+¢É­.9°±Ä0&nS..D..&F.&.'/'.6.:®/5..x/..x0."WN.O[.60..z0x0.".."W)/..y/N.SN.</5N.OTN.</5O/..Ox//..O0/N...kmþ/..Ox/.Oy0......þ//5..T..O.Ox.Oyx/..y/N.5.8É®/5.Ox/.Oy0..[..O.Oyx/.;.7±/8QM.,£/+.OyO~Ox/.8/'.*É/9N..Ox08/&.5.8°Ä/*.!N/./0O.*!/2O/././/0/.N..2ó03.ô.0ò..2ó04.ôò...2ó01..ôò.>.2ó0/.>ôò/0.3.3ô..ò.4.4ôò.1.1ôò././ôò/..ONy/.ONy/..Ox0Y./.&É/6..-..- ..- ..- /(.0-.0- .0- .0- /)N..]..y0O].O/.)./..(./0.*!//.O0/N..x./ó01..xô..ò/..Ox/.1.1ô.0ò/0.Oy0.....1ò0/././ò-/).0.0./ò0/././ò-/(..T..x.0O/..y/N..x8.*¡0&..x8¢.) /).Ox/.&.&¢.( /(.Oy0..Ox8É/:.5.6¯/6.'.).+¢É.(.+¢É­.9°±Ä0&nS..D..&F.&.'/'.6.:®/5.Ox/.Ox0.U`;class o{constructor(x={}){this.O=x.correlationSampleSize>0?x.correlationSampleSize:11025,this.t=x.initialGranularity>0?x.initialGranularity:16,this.N=x.i>=0?x.i:.5,this.o=!0===x.h,this.l=y.get(o),this.m=e.get(o),this.l||(this.o?(this.l=WebAssembly.compile(t(i)),this.m=Promise.resolve(66560)):(this.l=s().then(O=>O?WebAssembly.compile(t(N)):WebAssembly.compile(t(n))),this.m=s().then(O=>66560)),y.set(this.l),e.set(this.m)),this.F=function x(t,s,y,e,N){this.u=new Map,this.S=(O,x)=>Math.min(O.samplesDecoded,x.samplesDecoded,this.O),this.Y=(O,x)=>Math.min(O.samplesDecoded,x.samplesDecoded,this.t),this.p=(O,x,t)=>{const s=new Float32Array(x.buffer);let y=t/this.M;for(let e=0;e<O.length;e++)t+=O[e].length*this.M,s.set(O[e],y),y+=O[e].length;return t},this.W=(O,x,t)=>{const s=4+(t+O.samplesDecoded*O.channelData.length*this.M+x.reduce((O,x)=>x.samplesDecoded*x.channelData.length*this.M+O,0)+x.length*this.M+x.length*this.T)/this.U;return new WebAssembly.Memory({initial:s,$:s,h:this.o})},this.D=(O,x,t)=>[t,this.p(O.channelData,x,t)],this.k=(O,x,t)=>{const s=this.p(O.channelData,x,t),y=s+this.M;return[t,s,y,y+this.M]},this.A=(t,s)=>{let y=this.u.get(t);if(!y){let O,s="text/javascript",e=`'use strict';(${""+((O,x,t,s,y)=>{self.onmessage=e=>{new O(Promise.resolve(e.data.module),Promise.resolve(e.data.P),t,s,y).v.get(x).apply(null,e.data._).then(O=>{self.postMessage(O)})}})})(${""+x}, "${t}", ${this.o}, ${this.O}, ${this.t})`;try{O=void 0!==process.versions.node}catch{}y=O?`data:${s};base64,${Buffer.from(e).toString("base64")}`:URL.createObjectURL(new Blob([e],{type:s})),this.u.set(t,y)}const e=new(globalThis.Worker||O)(y,{name:"SynAudio"}),N=new Promise(O=>{e.onmessage=x=>{e.terminate(),O(x.data)}});return Promise.all([this.l,this.m]).then(([O,x])=>{e.postMessage({module:O,P:x,_:s})}),N},this.R=(O,x,t,s,y,e,N,n,i,o,r)=>this.l.then(x=>WebAssembly.instantiate(x,{env:{memory:O}})).then(({exports:h})=>{const c=new Map(Object.entries(h)).get("correlate"),a=new DataView(O.buffer);return c(x,t,s,y,e,N,n,i,o,r),{correlation:a.getFloat32(o,!0),sampleOffset:a.getUint32(r,!0)}}),this.q=(O,x)=>this.m.then(t=>{const s=this.W(O,[x],t);let y,e,N,n,i;[y,i]=this.D(O,s,t),[e,N,n,i]=this.k(x,s,i);const o=this.S(O,x),r=this.Y(O,x);return this.R(s,y,O.samplesDecoded,O.channelData.length,e,x.samplesDecoded,x.channelData.length,o,r,N,n)}),this.j=(O,x,t=1,s=()=>{})=>this.m.then(y=>{const e=this.W(O,x,y);let N,n,i,o,r;[N,r]=this.D(O,e,y);const h=x.map(x=>{[n,i,o,r]=this.k(x,e,r);const t=this.S(O,x),s=this.Y(O,x);let y=x.B||0,h=x.C||O.samplesDecoded;h-y<x.samplesDecoded&&(y=0,h=O.samplesDecoded);const c=Math.min(O.samplesDecoded,Math.max(0,y)),a=Math.min(O.samplesDecoded-c,Math.max(0,c+h));return[[e,N+c*O.channelData.length*this.M,a,O.channelData.length,n,x.samplesDecoded,x.channelData.length,t,s,i,o],c]});O=null,x=null;let c=0,a=0,l=0;const f=Array(h.length);return new Promise((O,x)=>{s(0);const y=()=>{if(c>=h.length)return void(0===a&&O(f));const e=c++;a++,this.A("_syncWasmMemory",h[e][0]).then(O=>{O.sampleOffset+=h[e][1],f[e]=O}).catch(x).finally(()=>{a--,l++,s(l/f.length),y()}),a<t&&y()};y()})}),this.I=(O,x,t)=>{const s=[],y=[0],e=this.S(O,x),N=Math.log(O.samplesDecoded*e)/Math.log(this.t+1)*Math.log(e/1e4+1);t=Math.max(Math.round(Math.min(t,N,O.samplesDecoded/e/4)),1);const n=Math.ceil(O.samplesDecoded/t);let i=0;for(let o=0;o<t;o++){const t={channelData:[]};for(let x=0;x<O.channelData.length;x++){const s=O.channelData[x].subarray(i,i+n+e);t.channelData.push(s),t.samplesDecoded=s.length}i+=n-e,y.push(i),s.push(this.V(t,x))}return Promise.all(s).then(O=>{let x=0,t=-1;for(let s=0;s<O.length;s++)O[s].correlation>t&&(x=s,t=O[s].correlation);return{correlation:O[x].correlation,sampleOffset:O[x].sampleOffset+y[x]}})},this.V=(O,x)=>this.A("_sync",[O,x]),this.G=(O,x,t)=>globalThis.Worker?this.A("_syncWorkerConcurrent",[O,x,t]):this.I(O,x,t),this.v=new Map([["_sync",this.q],["_syncWasmMemory",this.R],["_syncOneToMany",this.j],["_syncWorker",this.V],["_syncWorkerConcurrent",this.I]]),this.l=t,this.m=s,this.o=y,this.O=e,this.t=N,this.U=65536,this.M=Float32Array.BYTES_PER_ELEMENT,this.T=Uint32Array.BYTES_PER_ELEMENT},this.L=new this.F(this.l,this.m,this.o,this.O,this.t)}async syncWorkerConcurrent(O,x,t){return this.L.G(O,x,t>=1?t:1)}async syncWorker(O,x){return this.L.V(O,x)}async sync(O,x){return this.L.q(O,x)}async H(O,x,t,s){const y=this.L.j(O,x,t,s);return O=null,x=null,y}async syncMultiple(O,x){x=x>=1?x:8;const t=[],s=[];let y=()=>{},e=Promise.resolve(),N=0;const n=()=>{e=new Promise(O=>{y=O})};for(let f=0;f<O.length;f++)s.push({vertex:{}});for(let f=0;f<O.length;f++){const i=O[f],o=s[f].vertex;o.name=i.name,o.samplesDecoded=i.data.samplesDecoded,o.J=new Set;for(let r=0;r<O.length;r++){if(f===r)continue;const h=O[r],c=s[r];N++,t.push(this.syncWorker(i.data,h.data).then(O=>{O.correlation>this.N&&o.J.add({parent:o,vertex:c.vertex,samplesDecoded:h.data.samplesDecoded,...O}),N--,y()})),N>=x&&(n(),await e)}}await Promise.all(t);const i=(O,x)=>O.parent&&x.parent&&O.parent.samplesDecoded!==x.parent.samplesDecoded?O.parent.samplesDecoded>x.parent.samplesDecoded:O.correlation!==x.correlation?O.correlation>x.correlation:O.sampleOffset!==x.sampleOffset?O.sampleOffset>x.sampleOffset:O.vertex&&x.vertex&&O.vertex.name.localeCompare(x.vertex.name)<0,o=new Map,r=new Set,h=O=>{for(const x of O.J.values()){if(o.has(O))return o.get(O);o.set(O,x);const t=h(x.vertex),s=x;if(t){let O,x;i(t,s)?(O=t,x=s):(O=s,x=t),x.K||(x.K=new Set,r.add(x)),x.K.add(O),O.K&&O.K.delete(x)}o.delete(O)}};for(const{vertex:f}of s)h(f);for(const f of r)f.K.size&&f.parent.J.delete(f);const c=new Set;for(const f of s)c.add(f.vertex);for(const f of s)for(const O of f.vertex.J)c.delete(O.vertex);const a=(O,x,t,s=0)=>{for(const y of t)O.has(y.vertex)&&i(O.get(y.vertex),y)||O.set(y.vertex,{name:y.vertex.name,correlation:y.correlation,sampleOffset:s+y.sampleOffset}),a(O,x,y.vertex.J,s+y.sampleOffset)},l=[];for(const f of c){const O=new Map;O.set(f,{name:f.name,sampleOffset:0}),a(O,f,f.J),l.push([...O.values()].sort((O,x)=>O.sampleOffset-x.sampleOffset||(O.correlation||0)-(x.correlation||0)||x.name.localeCompare(O.name)))}return l}}return o},"object"==typeof exports&&"undefined"!=typeof module?module.exports=x(require("@eshaz/web-worker")):"function"==typeof define&&define.amd?define(["@eshaz/web-worker"],x):(O="undefined"!=typeof globalThis?globalThis:O||self).SynAudio=x(O.Worker);
//# sourceMappingURL=synaudio.min.js.map