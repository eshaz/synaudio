{"version":3,"names":["global","factory","this","Worker","t","n","e","r","Int32Array","o","s","c","i","length","Uint8Array","map","parseInt","substring","Map","forEach","set","a","l","f","g","h","p","u","DataView","buffer","getInt32","d","charCodeAt","get","m","subarray","console","error","Error","wasmModule","WeakMap","simdWasm","String","raw","scalarWasm","SynAudio","constructor","options","_correlationSampleSize","correlationSampleSize","_initialGranularity","initialGranularity","_correlationThreshold","correlationThreshold","_module","async","WebAssembly","validate","simd","then","simdSupported","compile","SynAudioWorker","module","_sourceCache","_getCorrelationSampleSize","b","Math","min","samplesDecoded","_getInitialGranularity","_setAudioDataOnHeap","input","output","heapPos","bytesPerElement","BYTES_PER_ELEMENT","floatPos","_executeAsWorker","functionName","params","source","isNode","type","webworkerSourceCode","self","onmessage","msg","Promise","resolve","data","_workerMethods","apply","results","postMessage","process","versions","node","Buffer","from","toString","URL","createObjectURL","Blob","worker","globalThis","name","result","message","terminate","_sync","floatByteLength","Float32Array","memory","Memory","initial","channelData","instantiate","env","exports","instanceExports","Object","entries","correlate","dataArray","heapView","aPtr","value","bPtr","bestCorrelationPtr","bestSampleOffsetPtr","correlation","getFloat32","sampleOffset","_syncWorkerConcurrent","threads","promises","lengths","maxThreads","log","max","round","aLength","ceil","offset","aSplit","cutChannel","push","_syncWorker","all","bestResultIdx","bestCorrelation","_syncWorkerConcurrentMain","_instance","syncWorkerConcurrent","syncWorker","sync","syncMultiple","clips","workers","graph","notify","wait","runningThreads","vertex","v","vertexClip","edges","Set","edgeClip","edge","correlationResult","add","parent","weighResults","localeCompare","path","cycles","detectCycle","values","has","cycleStartEdge","cycleEndEdge","keep","remove","cycleWith","delete","size","roots","traverseRoot","root","sampleOffsetFromRoot","sort","require","define","amd"],"sources":["synaudio.js"],"mappings":"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"}