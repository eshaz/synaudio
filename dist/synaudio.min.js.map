{"version":3,"names":["global","factory","this","Worker","r","t","Map","forEach","e","set","Uint8Array","length","n","o","s","l","g","substring","parseInt","c","a","charCodeAt","get","subarray","wasmModule","WeakMap","simdWasm","String","raw","scalarWasm","SynAudio","constructor","options","_correlationSampleSize","correlationSampleSize","_initialGranularity","initialGranularity","_correlationThreshold","correlationThreshold","_module","async","WebAssembly","validate","simd","then","simdSupported","compile","SynAudioWorker","module","_sourceCache","_getCorrelationSampleSize","b","Math","min","samplesDecoded","_getInitialGranularity","_setAudioDataOnHeap","input","output","heapPos","bytesPerElement","BYTES_PER_ELEMENT","floatPos","i","_executeAsWorker","functionName","params","source","webworkerSourceCode","self","onmessage","msg","Promise","resolve","data","_workerMethods","apply","results","postMessage","type","URL","createObjectURL","Blob","Buffer","from","toString","worker","globalThis","name","result","message","terminate","_sync","floatByteLength","Float32Array","memory","Memory","initial","channelData","instantiate","env","exports","instanceExports","Object","entries","correlate","dataArray","buffer","heapView","DataView","aPtr","value","bPtr","bestCorrelationPtr","bestSampleOffsetPtr","correlation","getFloat32","sampleOffset","getInt32","_syncWorkerConcurrent","threads","promises","lengths","maxThreads","log","max","round","aLength","ceil","offset","aSplit","cutChannel","push","_syncWorker","all","bestResultIdx","bestCorrelation","_syncWorkerConcurrentMain","_instance","clips","workers","graph","notify","wait","runningThreads","vertex","v","vertexClip","edges","Set","edgeClip","edge","syncWorker","correlationResult","add","parent","weighResults","localeCompare","path","cycles","detectCycle","values","has","cycleStartEdge","cycleEndEdge","keep","remove","cycleWith","delete","M","size","roots","traverseRoot","root","sampleOffsetFromRoot","sort","require","define","amd"],"sources":["synaudio.js"],"mappings":"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"}