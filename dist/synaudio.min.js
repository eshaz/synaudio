/* Copyright 2022 Ethan Halsall. This file is part of synaudio. https://github.com/eshaz/synaudio */
var P,y;P=this,y=function(P){const y=(P,y=4294967295,t=79764919)=>{const e=new Int32Array(256);let s,n,o,O=y;for(s=0;s<256;s++){for(o=s<<24,n=8;n>0;--n)o=2147483648&o?o<<1^t:o<<1;e[s]=o}for(s=0;s<P.length;s++)O=O<<8^e[255&(O>>24^P[s])];return O},t=(P,t=y)=>{const e=P=>new Uint8Array(P.length/2).map((y,t)=>parseInt(P.substring(2*t,2*(t+1)),16)),s=P=>e(P)[0],n=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((P,y)=>n.set(P,y));const o=new Uint8Array(P.length);let O,r,i,z=!1,c=0,a=42,h=P.length>13&&"dynEncode"===P.substring(0,9),f=0;h&&(f=11,r=s(P.substring(9,f)),r<=1&&(f+=2,a=s(P.substring(11,f))),1===r&&(f+=8,i=(P=>new DataView(e(P).buffer).getInt32(0,!0))(P.substring(13,f))));const l=256-a;for(let y=f;y<P.length;y++)if(O=P.charCodeAt(y),61!==O||z){if(92===O&&y<P.length-5&&h){const t=P.charCodeAt(y+1);117!==t&&85!==t||(O=parseInt(P.substring(y+2,y+6),16),y+=5)}if(O>255){const P=n.get(O);P&&(O=P+127)}z&&(z=!1,O-=64),o[c++]=O<a&&O>0?O+l:O-a}else z=!0;const p=o.subarray(0,c);if(h&&1===r){const P=t(p);if(P!==i){const y="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",y+"\n","Expected: "+i+"; Got: "+P+"\n","Visit https://github.com/eshaz/simple-yenc for more information"),Error(y)}}return p},e=new WeakMap,s=String.raw`dynEncode010f265bd8a8p|ot}|t|~P*r~t{ptnnwtpnqptÙ1Ö1OP0'S0<OO/PW/Pz0%/P ]O//P z1P1P y1//Y*1P0&//&/zPy0//P1Py1/P/PPOzy0$/P0"/Py0/POz0 //zPz1PZ0!/Py1//&zy0O/0/0O////y1ó///ó/////ó///?/?ó?/POz0/Pz1O//[/0O/!T/ /"/#{1y/$X//$y/ Z/ 0/0O///y/ó/Py0/Py1/0/&T//Py0O///y9/9¡G/Py0//Py1Y//"y0/#Py1#/%V/P[//P1 y/Z//PPz/{y/ZP/PX0/P0/P?y0$/P/y0"/Py0!//'0OP0O/TO////#{P1y/óO/PU/!//!y/!ó/PU/"//"y/"ó/PU/$//$y/$ó//1U/0/O//y0//Py0/0O///y9/9¡G/Py0/Pz1//zPZ//z0//Py0O///y19/9¡G//9/9¡G//9/9¡G//9/9¡G/Py0/Pz1// y0/#Py1#/%VO/PW/Pz0$/P ]O//P z1P1P y1//W*1P0%//%/zPy0//P1Py1/P/PPOzy0"/P0!/Py0/POz0P0//zPz1PZ0 /Py1//%zy0P0#O/0/0O////y1ó///ó/////ó///?/?ó?/POz0/Pz1O//[/0O/ T//!/#{1y/"X//"y/Z/0/0O///y/ó/Py0/Py1/0/%T//Py0O///y9/9¡G/Py0//Py1Y//!y0/#Py1#/$V/P[//P1y/Z//PPz/{y/ZP/PX0/P0/P?y0"/P/y0!/Py0 //'0P0P0#OP0O/TO////#{P1y/óO/PU/ // y/ ó/PU/!//!y/!ó/PU/"//"y/"ó//1U/0/O//y0//Py0/0O///y9/9¡G/Py0/Pz1//zPZ//z0//Py0O///y19/9¡G//9/9¡G//9/9¡G//9/9¡G/Py0/Pz1//y0/#Py1#/$VP0!/PE/PE/PYO/P0O/Pz1PXOP0/0//'10O/8/9Ê¯/9Ê¯/9Ê¯/9Ê¯08/Py0/Pz1/O//Py0/0O/8/9Ê¯08/Py0/Pz1O/PXOP0/0//'10O/9/9Ê¯/9Ê¯/9Ê¯/9Ê¯09/Py0/Pz1/O//Py0O/9/9Ê¯09/Py0/Pz1/Pz0/9/Æ19²Å0)P/P W)/)"04P0/0O/1//4ô12/2õó//4ô12/2õó///4ô12/2õó/?/4ô12/2õó01/POz0//Py1YP0!/P zPPy/Pz0/</Æ19²Å0)P0/1./1./1./1.¡¡¡0*O//]//zP1//Py0/0O/9/)¢1(/(£/*¡0*/Py0/Pz1//y/0//zPZ//z0//Py0O/9/)¢1(/(£/9/)¢1(/(£/9/)¢1(/(£/9/)¢1(/(£/*¡¡¡¡0*/Py0/Pz1P0/!O/)"02/0O///2ô///2ô////2ô///?/2ô?/POz0//Py1Y/*/ÁRÎ¡1.¤0(//z0 O//[///z1PZ//Py0/)"02/P10O///2ô/Py0/Pz1//U//y/1z0//Py0O//9/)¢G/Py0/Pz1/( 0,/ PYO/P0/Pz0/P zPPy0/90)/,Ê0:P0/0O//Py1900/8/9²Å0//!TO0103P//"05P0P00301O/3//y1/5ô16//y1õó//5ô17/õó///5ô14//õó/?/5ô12/?õó03/1/6/6õó/7/7õó/4/4õó/2/2õó01/POz0//Py1Y/0/1./1./1./1.¡¡¡0*/3./3./3./3.¡¡¡0+O//]//zP//P1y9//¢1(//y9£/+¡0+/(/(£/*¡0*/Py/0//U/P0//z0O//y19//¢1-//y19£/9//¢1(/9£/+¡¡0+/-/-£/(/(£/*¡¡0*/Py0/Pz1//Py9Ê0;/)/+/.¤Ê/*/.¤Ê®/:±²Å1(l//E//(G/(/)0)/8/0Ê°/;¯08//y0//y1/ WO/P[/71//{1y1/ // W*0P0//z1P/PY*0O/P[O/<08/P0O/PzPXO/<08//Py0/<08//'10O/8/9Ê¯/9Ê¯/9Ê¯/9Ê¯08/Py0/Pz1/T//P/Pyy0O/8/9Ê¯08/Py0/Pz1//]/Pz0//Py0/P zPPy0/90)/,Ê0:O//Py1900/8/9²Å0,/!TO0103P/,"05P0/0/00301O/3//5ô16/õó//5ô17/õó///5ô14//õó/?/5ô12/?õó03/1/6/6õó/7/7õó/4/4õó/2/2õó01/POz0/POz0//Py1Y/0/1./1./1./1.¡¡¡0*/3./3./3./3.¡¡¡0+O//]//zP//P1y9/,¢1(//y9£/+¡0+/(/(£/*¡0*/Py/0//U/P0//z0O//y19/,¢1-//y19£/9/,¢1(/9£/+¡¡0+/-/-£/(/(£/*¡¡0*/Py0/Pz1//Py9Ê0;/)/+/.¤Ê/*/.¤Ê®/:±²Å1(l//E//(G/(/)0)/8/0Ê°/;¯08/Py0/Py1/VDpvtnutpt:|pq{t<v{~qp{:x|s@AG:xv}<t`,n=String.raw`dynEncode010f317f7943p|,ooot}|t|~P*r~t{ptnnwtpnqptà ¡O/PW/Pz0/P]O/Pz0/P0/Py10O/0/0/0P0O///y19/9¡G//9/9¡G//9/9¡G//9/9¡G/1Py0/1Py0/Py0//Py1Y//YOO//9/9¡G/Py0/Py0//Py1Y//y0//y0/Py1/V/P[/P0/90/PU0/PU0/0O//9/¡1GO///9/9¡G/PU//9/9¡G///9/9¡G//y0/Pz1O/1PWP/Pz0/Pz0O//y19/¢1//y19£/9/¢1/9£/9/¢1/9£/9/¢1/9£/¡¡¡¡0//£//£//£//£/¡¡¡¡0/Py0//Py1Y/PPy1/]//zP//P1y9/¢1//y9£/¡0//£/¡0/Py/0/Pz/U//z0//P1y0//y0O/9/¢1/£/9/¢1/£/¡¡0//9£//9£/¡¡0/Py0/Py0/Pz1//ÁRÎ¡1¤Ê//¤Ê®/Ê±²ÅÁOP0S0%O///////PE/PE/PYO/P0/Pz1P^O/0//10O/!/9Ê¯/9Ê¯/9Ê¯/9Ê¯0!/Py0/Pz1/O/P/y0/0O/!/9Ê¯0!/Py0/Pz1/P^O/0//10O/"/9Ê¯/9Ê¯/9Ê¯/9Ê¯0"/Py0/Pz1/O/P/y0O/"/9Ê¯0"/Py0/Pz1/Pz0/Á0 /PWOP0P/"Å/ ¤0P0/0O/9/¢1/£/9/¢1/£/9/¢1/£/9/¢1/£/¡¡¡¡0/Py0/Py1/WP0/PzPPy/Pz0/Á0 P0/"/Æ1"²Å0O//]//zP1/P/y0/0O/9/¢1/£/¡0/Py0/Pz1//y/0//zPZ//z0/P/y0O/9/¢1/£/9/¢1/£/9/¢1/£/9/¢1/£/¡¡¡¡0/Py0/Pz1P0/O/0O//9/¢G//9/¢G//9/¢G//9/¢G/Py0/Py1/W// RÎ¡¤0//z0O//]/0//zP1O//y0/P/y0O//9/¢G/Py0/Pz1//zPZ//z0/P/y0O//9/¢G//9/¢G//9/¢G//9/¢G/Py0/Pz1/ 0O/P[OP0/P0/P0P0/0P0O/!/9Ê°0#//y9Ê0$/90///!/"²Å//1 /m//E// G//0/#/$¯0!//y0//y1/WO/P[///{1y1///W*0P0//z1P/PY*0O/P[O/%0!/P0O/PzPXO/%0!/P/y0/%0!//10O/!/9Ê¯/9Ê¯/9Ê¯/9Ê¯0!/Py0/Pz1/T/P/Py/y0O/!/9Ê¯0!/Py0/Pz1//]/P0/P/y0O/!/9Ê°0#//y9Ê0$/90///!/"²Å//1 /mO//E// G/#/$¯0!/Py0/Py1/V;pvtnutpt:|pq{t<v{~qp{:xv}<t`;class o{constructor(y={}){this.P=y.correlationSampleSize>0?y.correlationSampleSize:11025,this.t=y.initialGranularity>0?y.initialGranularity:16,this.o=y.O>=0?y.O:.5,this.i=e.get(o),this.i||(this.i=(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))().then(P=>P?WebAssembly.compile(t(s)):WebAssembly.compile(t(n))),e.set(this.i)),this.h=function y(t,e,s){this.l=new Map,this.p=(P,y)=>Math.min(P.samplesDecoded,y.samplesDecoded,this.P),this.G=(P,y)=>Math.min(P.samplesDecoded,y.samplesDecoded,this.t),this.u=(P,y,t)=>{const e=y.BYTES_PER_ELEMENT;let s=t/e;for(let n=0;n<P.length;n++)t+=P[n].length*e,y.set(P[n],s),s+=P[n].length;return t},this.m=(t,e)=>{let s=this.l.get(t);if(!s){let P,e="text/javascript",n=`'use strict';(${""+((P,y,t,e)=>{self.onmessage=s=>{new P(Promise.resolve(s.data.module),t,e).W.get(y).apply(null,s.data.$).then(P=>{self.postMessage(P)})}})})(${""+y}, "${t}", ${this.P}, ${this.t})`;try{P=void 0!==process.versions.node}catch{}s=P?`data:${e};base64,${Buffer.from(n).toString("base64")}`:URL.createObjectURL(new Blob([n],{type:e})),this.l.set(t,s)}const n=new(globalThis.Worker||P)(s,{name:"SynAudio"}),o=new Promise(P=>{n.onmessage=y=>{n.terminate(),P(y.data)}});return this.i.then(P=>{n.postMessage({module:P,$:e})}),o},this.U=(P,y)=>{const t=Float32Array.BYTES_PER_ELEMENT,e=this.p(P,y),s=this.G(P,y),n=new WebAssembly.Memory({initial:(P.samplesDecoded*P.channelData.length+y.samplesDecoded*y.channelData.length)*t/65536+4});return this.i.then(P=>WebAssembly.instantiate(P,{env:{memory:n}})).then(({exports:o})=>{const O=new Map(Object.entries(o)),r=O.get("correlate"),i=new Float32Array(n.buffer),z=new DataView(n.buffer),c=O.get("__heap_base").value,a=this.u(P.channelData,i,c),h=this.u(y.channelData,i,a),f=h+t;return r(c,P.samplesDecoded,P.channelData.length,a,y.samplesDecoded,y.channelData.length,e,s,h,f),{correlation:z.getFloat32(h,!0),sampleOffset:z.getInt32(f,!0)}})},this.M=(P,y,t)=>{const e=[],s=[0],n=this.p(P,y),o=Math.log(P.samplesDecoded*n)/Math.log(this.t+1)*Math.log(n/1e4+1);t=Math.max(Math.round(Math.min(t,o,P.samplesDecoded/n/4)),1);const O=Math.ceil(P.samplesDecoded/t);let r=0;for(let i=0;i<t;i++){const t={channelData:[]};for(let y=0;y<P.channelData.length;y++){const e=P.channelData[y].subarray(r,r+O+n);t.channelData.push(e),t.samplesDecoded=e.length}r+=O-n,s.push(r),e.push(this.Y(t,y))}return Promise.all(e).then(P=>{let y=0,t=-1;for(let e=0;e<P.length;e++)P[e].correlation>t&&(y=e,t=P[e].correlation);return{correlation:P[y].correlation,sampleOffset:P[y].sampleOffset+s[y]}})},this.Y=(P,y)=>this.m("_sync",[P,y]),this.v=(P,y,t)=>globalThis.Worker?this.m("_syncWorkerConcurrent",[P,y,t]):this.M(P,y,t),this.W=new Map([["_sync",this.U],["_syncWorker",this.Y],["_syncWorkerConcurrent",this.M]]),this.i=t,this.P=e,this.t=s},this.T=new this.h(this.i,this.P,this.t)}async syncWorkerConcurrent(P,y,t){return this.T.v(P,y,t>=1?t:1)}async syncWorker(P,y){return this.T.Y(P,y)}async sync(P,y){return this.T.U(P,y)}async syncMultiple(P,y){y=y>=1?y:8;const t=[],e=[];let s=()=>{},n=Promise.resolve(),o=0;const O=()=>{n=new Promise(P=>{s=P})};for(let l=0;l<P.length;l++)e.push({vertex:{}});for(let l=0;l<P.length;l++){const r=P[l],i=e[l].vertex;i.name=r.name,i.samplesDecoded=r.data.samplesDecoded,i.Z=new Set;for(let z=0;z<P.length;z++){if(l===z)continue;const c=P[z],a=e[z];o++,t.push(this.syncWorker(r.data,c.data).then(P=>{P.correlation>this.o&&i.Z.add({parent:i,vertex:a.vertex,samplesDecoded:c.data.samplesDecoded,...P}),o--,s()})),o>=y&&(O(),await n)}}await Promise.all(t);const r=(P,y)=>P.parent&&y.parent&&P.parent.samplesDecoded!==y.parent.samplesDecoded?P.parent.samplesDecoded>y.parent.samplesDecoded:P.correlation!==y.correlation?P.correlation>y.correlation:P.sampleOffset!==y.sampleOffset?P.sampleOffset>y.sampleOffset:P.vertex&&y.vertex&&P.vertex.name.localeCompare(y.vertex.name)<0,i=new Map,z=new Set,c=P=>{for(const y of P.Z.values()){if(i.has(P))return i.get(P);i.set(P,y);const t=c(y.vertex),e=y;if(t){let P,y;r(t,e)?(P=t,y=e):(P=e,y=t),y.A||(y.A=new Set,z.add(y)),y.A.add(P),P.A&&P.A.delete(y)}i.delete(P)}};for(const{vertex:l}of e)c(l);for(const l of z)l.A.size&&l.parent.Z.delete(l);const a=new Set;for(const l of e)a.add(l.vertex);for(const l of e)for(const P of l.vertex.Z)a.delete(P.vertex);const h=(P,y,t,e=0)=>{for(const s of t)P.has(s.vertex)&&r(P.get(s.vertex),s)||P.set(s.vertex,{name:s.vertex.name,correlation:s.correlation,sampleOffset:e+s.sampleOffset}),h(P,y,s.vertex.Z,e+s.sampleOffset)},f=[];for(const l of a){const P=new Map;P.set(l,{name:l.name,sampleOffset:0}),h(P,l,l.Z),f.push([...P.values()].sort((P,y)=>P.sampleOffset-y.sampleOffset||(P.correlation||0)-(y.correlation||0)||y.name.localeCompare(P.name)))}return f}}return o},"object"==typeof exports&&"undefined"!=typeof module?module.exports=y(require("@eshaz/web-worker")):"function"==typeof define&&define.amd?define(["@eshaz/web-worker"],y):(P="undefined"!=typeof globalThis?globalThis:P||self).SynAudio=y(P.Worker);
//# sourceMappingURL=synaudio.min.js.map