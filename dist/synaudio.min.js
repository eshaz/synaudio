/* Copyright 2022 Ethan Halsall. This file is part of synaudio. https://github.com/eshaz/synaudio */
var P,t;P=this,t=function(P){const t=(P,t=4294967295,y=79764919)=>{const e=new Int32Array(256);let s,n,o,r=t;for(s=0;s<256;s++){for(o=s<<24,n=8;n>0;--n)o=2147483648&o?o<<1^y:o<<1;e[s]=o}for(s=0;s<P.length;s++)r=r<<8^e[255&(r>>24^P[s])];return r},y=(P,y=t)=>{const e=P=>new Uint8Array(P.length/2).map((t,y)=>parseInt(P.substring(2*y,2*(y+1)),16)),s=P=>e(P)[0],n=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((P,t)=>n.set(P,t));const o=new Uint8Array(P.length);let r,i,O,z=!1,a=0,h=42,c=P.length>13&&"dynEncode"===P.substring(0,9),l=0;c&&(l=11,i=s(P.substring(9,l)),i<=1&&(l+=2,h=s(P.substring(11,l))),1===i&&(l+=8,O=(P=>new DataView(e(P).buffer).getInt32(0,!0))(P.substring(13,l))));const f=256-h;for(let t=l;t<P.length;t++)if(r=P.charCodeAt(t),61!==r||z){if(92===r&&t<P.length-5&&c){const y=P.charCodeAt(t+1);117!==y&&85!==y||(r=parseInt(P.substring(t+2,t+6),16),t+=5)}if(r>255){const P=n.get(r);P&&(r=P+127)}z&&(z=!1,r-=64),o[a++]=r<h&&r>0?r+f:r-h}else z=!0;const p=o.subarray(0,a);if(c&&1===i){const P=y(p);if(P!==O){const t="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",t+"\n","Expected: "+O+"; Got: "+P+"\n","Visit https://github.com/eshaz/simple-yenc for more information"),Error(t)}}return p},e=new WeakMap,s=String.raw`dynEncode010fe4732c5fpÂ‚|oÂÂÂÂÂÂÂÂÂÂ!t}Â…|t|~ÂÂˆÂÂÂPÂÂ—*r~ÂÂt{pÂƒtnnwtpnqpÂ‚tÃ™1Ã–1ÂÂŒÂŠÂ‹OP0'S0<OO/PW/Pz0%/P ]O//P z1PÂ€1P y1//Y*1PÂ€0&//&Â/zPy0//PÂ…1PÂƒy1/PÂƒ/PÂƒPOÂ€zy0$/PÂƒ0"/Py0/POz0 //zPz1PZ0!/Py1//&zy0O/0/0O////y1Ã³///Ã³/////Ã³///?/?Ã³?/POz0/Pz1O//[/0O/!T/ /"/#{1y/$X//$y/ ZÂ€/ 0/0O///y/Ã³/Py0/Py1/0/&T//PÂƒy0O///y9/9Â¡G/Py0//Py1Y//"y0/#Py1#/%V/P[//PÂƒ1 y/ZÂ//PÂƒPz/{y/ZP/PXÂ0/PÂ€0/P?y0$/P/y0"/Py0!//'Â€0OP0O/TO////#{PÂƒ1y/Ã³O/PU/!//!y/!Ã³/PU/"//"y/"Ã³/PU/$//$y/$Ã³//1U/0/O//y0//PÂƒy0/0O///y9/9Â¡G/Py0/Pz1//zPÂ‹Z//z0//PÂƒy0O///y19/9Â¡G//9/9Â¡G//9/9Â¡G//9/9Â¡G/Py0/Pz1// y0/#Py1#/%VO/PW/Pz0$/P ]O//P z1PÂ€1P y1//W*1PÂ€0%//%Â/zPy0//PÂ…1PÂƒy1/PÂƒ/PÂƒPOÂ€zy0"/PÂƒ0!/Py0/POz0P0//zPz1PZ0 /Py1//%zy0P0#O/0/0O////y1Ã³///Ã³/////Ã³///?/?Ã³?/POz0/Pz1O//[/0O/ T//!/#{1y/"X//"y/ZÂ€/0/0O///y/Ã³/Py0/Py1/0/%T//PÂƒy0O///y9/9Â¡G/Py0//Py1Y//!y0/#Py1#/$V/P[//PÂƒ1y/ZÂ//PÂƒPz/{y/ZP/PXÂ0/PÂ€0/P?y0"/P/y0!/Py0 //'Â€0P0P0#OP0O/TO////#{PÂƒ1y/Ã³O/PU/ // y/ Ã³/PU/!//!y/!Ã³/PU/"//"y/"Ã³//1U/0/O//y0//PÂƒy0/0O///y9/9Â¡G/Py0/Pz1//zPÂ‹Z//z0//PÂƒy0O///y19/9Â¡G//9/9Â¡G//9/9Â¡G//9/9Â¡G/Py0/Pz1//y0/#Py1#/$VP0!/PE/PEÂ/PYO/PÂ€0O/Pz1PXOP0/0//'Â€10O/8/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯08/Py0/Pz1/O//PÂƒy0/0O/8/9ÃŠÂ¯08/Py0/Pz1O/PXOP0/0//'Â€10O/9/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯09/Py0/Pz1/O//PÂƒy0O/9/9ÃŠÂ¯09/Py0/Pz1/Pz0/9/Ã†19Â²Ã…0)P/P W)/)"04P0/0O/1//4Ã´12/2ÃµÃ³//4Ã´12/2ÃµÃ³///4Ã´12/2ÃµÃ³/?/4Ã´12/2ÃµÃ³01/POz0//Py1YP0!/P zPÂ€Py/Pz0/</Ã†19Â²Ã…0)P0/1./1./1./1.Â¡Â¡Â¡0*O//]//zPÂ€1Â//PÂƒy0/0O/9/)Â¢1(/(Â£/*Â¡0*/Py0/Pz1//y/0//zPÂ‹Z//z0//PÂƒy0O/9/)Â¢1(/(Â£/9/)Â¢1(/(Â£/9/)Â¢1(/(Â£/9/)Â¢1(/(Â£/*Â¡Â¡Â¡Â¡0*/Py0/Pz1P0/!O/)"02/0O///2Ã´///2Ã´////2Ã´///?/2Ã´?/POz0//Py1Y/*/ÃRÂÃÂ¡1.Â¤0(//z0 O//[///z1PZÂ//PÂƒy0/)"02/PÂ‹Â€10O///2Ã´/Py0/Pz1//U//y/1z0//PÂƒy0O//9/)Â¢G/Py0/Pz1/(Â 0,/ PYO/PÂƒ0/Pz0/P zPÂ€Py0/90)/,ÃŠ0:P0/0O//PÂƒy1900/8/9Â²Ã…0/Â/!TO0103P//"05P0P00301O/3//y1/5Ã´16//y1ÃµÃ³//5Ã´17/ÃµÃ³///5Ã´14//ÃµÃ³/?/5Ã´12/?ÃµÃ³03/1/6/6ÃµÃ³/7/7ÃµÃ³/4/4ÃµÃ³/2/2ÃµÃ³01/POz0//Py1Y/0/1./1./1./1.Â¡Â¡Â¡0*/3./3./3./3.Â¡Â¡Â¡0+O//]//zPÂ€Â//PÂƒ1y9//Â¢1(//y9Â£/+Â¡0+/(/(Â£/*Â¡0*/Py/0//U/PÂƒ0//z0O//y19//Â¢1-//y19Â£/9//Â¢1(/9Â£/+Â¡Â¡0+/-/-Â£/(/(Â£/*Â¡Â¡0*/Py0/Pz1//PÂƒy9ÃŠ0;/)/+/.Â¤ÃŠ/*/.Â¤ÃŠÂ®/:Â±Â²Ã…1(lÂŒ//E//(G/(/)0)/8/0ÃŠÂ°/;Â¯08//y0//y1/ WO/P[/71//{1y1/ // W*0P0//z1P/PY*0O/P[O/<08/PÂ€0O/PzPXO/<08//PÂƒy0/<08//'Â€10O/8/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯08/Py0/Pz1/T//PÂƒ/PÂƒyy0O/8/9ÃŠÂ¯08/Py0/Pz1//]/Pz0//PÂƒy0/P zPÂ€Py0/90)/,ÃŠ0:O//PÂƒy1900/8/9Â²Ã…0,Â/!TO0103P/,"05P0/0/00301O/3//5Ã´16/ÃµÃ³//5Ã´17/ÃµÃ³///5Ã´14//ÃµÃ³/?/5Ã´12/?ÃµÃ³03/1/6/6ÃµÃ³/7/7ÃµÃ³/4/4ÃµÃ³/2/2ÃµÃ³01/POz0/POz0//Py1Y/0/1./1./1./1.Â¡Â¡Â¡0*/3./3./3./3.Â¡Â¡Â¡0+O//]//zPÂ€Â//PÂƒ1y9/,Â¢1(//y9Â£/+Â¡0+/(/(Â£/*Â¡0*/Py/0//U/PÂƒ0//z0O//y19/,Â¢1-//y19Â£/9/,Â¢1(/9Â£/+Â¡Â¡0+/-/-Â£/(/(Â£/*Â¡Â¡0*/Py0/Pz1//PÂƒy9ÃŠ0;/)/+/.Â¤ÃŠ/*/.Â¤ÃŠÂ®/:Â±Â²Ã…1(lÂŒ//E//(G/(/)0)/8/0ÃŠÂ°/;Â¯08/Py0/Py1/VZÂƒpÂvtÂƒnutpÂƒÂ„ÂtÂ‚:pÂƒ~|xrÂ‚:|Â„Âƒpq{t<v{~qp{Â‚:Â‚x|s@AG:qÂ„{z<|t|~ÂÂˆ:Â‚xv}<tÂ‡Âƒ`,n=String.raw`dynEncode010f317f7943pÂ‚|,oÂÂÂoÂÂÂŒÂŒÂÂŒoÂÂÂÂÂÂÂÂÂÂt}Â…|t|~ÂÂˆÂPÂÂ—*r~ÂÂt{pÂƒtnnwtpnqpÂ‚tÃ  Â¡ÂÂŒO/PW/Pz0/P]O/Pz0/PÂƒ0/Py10O/0/0/0P0O///y19/9Â¡G//9/9Â¡G//9/9Â¡G//9/9Â¡G/1Py0/1Py0/Py0//Py1Y//YOO//9/9Â¡G/Py0/Py0//Py1Y//y0//y0/Py1/V/P[/PÂƒ0/90/PU0/PU0/0O//9/Â¡1GO///9/9Â¡G/PU//9/9Â¡G///9/9Â¡G//y0/Pz1Â•ÂÂŒO/1PWÂP/Pz0/Pz0O//y19/Â¢1//y19Â£/9/Â¢1/9Â£/9/Â¢1/9Â£/9/Â¢1/9Â£/Â¡Â¡Â¡Â¡0//Â£//Â£//Â£//Â£/Â¡Â¡Â¡Â¡0/Py0//Py1Y/PÂ‹Â€Py1/]//zPÂ€Â//PÂƒ1y9/Â¢1//y9Â£/Â¡0//Â£/Â¡0/Py/0/Pz/U//z0//PÂƒ1y0//y0O/9/Â¢1/Â£/9/Â¢1/Â£/Â¡Â¡0//9Â£//9Â£/Â¡Â¡0/Py0/Py0/Pz1//ÃRÂÃÂ¡1Â¤ÃŠ//Â¤ÃŠÂ®/ÃŠÂ±Â²Ã…ÃÂÂŒÂ‹OP0S0%O///////PE/PEÂ/PYO/PÂ€0/Pz1P^O/0//Â€10O/!/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯0!/Py0/Pz1/O/PÂƒ/y0/0O/!/9ÃŠÂ¯0!/Py0/Pz1/P^O/0//Â€10O/"/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯0"/Py0/Pz1/O/PÂƒ/y0O/"/9ÃŠÂ¯0"/Py0/Pz1/Pz0/Ã0 /PWOP0P/"Ã…/ Â¤0P0/0O/9/Â¢1/Â£/9/Â¢1/Â£/9/Â¢1/Â£/9/Â¢1/Â£/Â¡Â¡Â¡Â¡0/Py0/Py1/WP0/PzPÂ‹Â€Py/Pz0/Ã0 P0/"/Ã†1"Â²Ã…0O//]//zPÂ€1Â/PÂƒ/y0/0O/9/Â¢1/Â£/Â¡0/Py0/Pz1//y/0//zPÂ‹Z//z0/PÂƒ/y0O/9/Â¢1/Â£/9/Â¢1/Â£/9/Â¢1/Â£/9/Â¢1/Â£/Â¡Â¡Â¡Â¡0/Py0/Pz1P0/O/0O//9/Â¢G//9/Â¢G//9/Â¢G//9/Â¢G/Py0/Py1/W// RÂÃÂ¡Â¤0//z0O//]/0//zPÂ€1O//y0/PÂƒ/y0O//9/Â¢G/Py0/Pz1//zPÂ‹Z//z0/PÂƒ/y0O//9/Â¢G//9/Â¢G//9/Â¢G//9/Â¢G/Py0/Pz1/Â 0O/P[OP0/PÂƒ0/PÂƒ0P0/0P0O/!/9ÃŠÂ°0#//y9ÃŠ0$/90///!/"Â²Ã…//1 /mÂ//E// G//0/#/$Â¯0!//y0//y1/WO/P[///{1y1///W*0P0//z1P/PY*0O/P[O/%0!/PÂ€0O/PzPXO/%0!/PÂƒ/y0/%0!//Â€10O/!/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯/9ÃŠÂ¯0!/Py0/Pz1/T/PÂƒ/PÂƒy/y0O/!/9ÃŠÂ¯0!/Py0/Pz1//]/PÂƒ0/PÂƒ/y0O/!/9ÃŠÂ°0#//y9ÃŠ0$/90///!/"Â²Ã…//1 /mO//E// G/#/$Â¯0!/Py0/Py1/V;ÂƒpÂvtÂƒnutpÂƒÂ„ÂtÂ‚:|Â„Âƒpq{t<v{~qp{Â‚:Â‚xv}<tÂ‡Âƒ`;class o{constructor(t={}){this.P=t.correlationSampleSize>0?t.correlationSampleSize:11025,this.t=t.initialGranularity>0?t.initialGranularity:16,this.o=t.i>=0?t.i:.5,this.O=e.get(o),this.O||(this.O=(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))().then(P=>P?WebAssembly.compile(y(s)):WebAssembly.compile(y(n))),e.set(this.O)),this.h=this.O.then(()=>WebAssembly.instantiate(module,{})).then(P=>P.exports.__heap_base.value),this.l=function t(y,e,s,n){this.p=new Map,this.m=(P,t)=>Math.min(P.samplesDecoded,t.samplesDecoded,this.P),this.u=(P,t)=>Math.min(P.samplesDecoded,t.samplesDecoded,this.t),this.G=(P,t,y)=>{const e=t.BYTES_PER_ELEMENT;let s=y/e;for(let n=0;n<P.length;n++)y+=P[n].length*e,t.set(P[n],s),s+=P[n].length;return y},this.W=(y,e)=>{let s=this.p.get(y);if(!s){let P,e="text/javascript",n=`'use strict';(${""+((P,t,y,e)=>{self.onmessage=s=>{new P(Promise.resolve(s.data.module),y,e).M.get(t).apply(null,s.data.$).then(P=>{self.postMessage(P)})}})})(${""+t}, "${y}", ${this.P}, ${this.t})`;try{P=void 0!==process.versions.node}catch{}s=P?`data:${e};base64,${Buffer.from(n).toString("base64")}`:URL.createObjectURL(new Blob([n],{type:e})),this.p.set(y,s)}const n=new(globalThis.Worker||P)(s,{name:"SynAudio"}),o=new Promise(P=>{n.onmessage=t=>{n.terminate(),P(t.data)}});return this.O.then(P=>{n.postMessage({module:P,$:e})}),o},this.U=(P,t,y,e,s,n,o,r,i,O,z)=>this.O.then(t=>WebAssembly.instantiate(t,{env:{memory:P}})).then(({exports:a})=>{const h=new Map(Object.entries(a)),c=h.get("correlate"),l=new DataView(P.buffer),f=h.get("__heap_base").value;return console.log("heap base",f),c(t+f,y,e,s+f,n,o,r,i,O+f,z+f),{correlation:l.getFloat32(O+f,!0),sampleOffset:l.getInt32(z+f,!0)}}),this.T=(P,t)=>{const y=Float32Array.BYTES_PER_ELEMENT,e=(P.samplesDecoded*P.channelData.length*y+t.samplesDecoded*t.channelData.length*y+2*y)/65536+4,s=new WebAssembly.Memory({initial:e,A:e,Y:!0}),n=new Float32Array(s.buffer);return this.h.then(e=>{const o=e,r=this.G(P.channelData,n,o),i=this.G(t.channelData,n,r),O=i+y,z=this.m(P,t),a=this.u(P,t);return this.U(s,o,P.samplesDecoded,P.channelData.length,r,t.samplesDecoded,t.channelData.length,z,a,i,O)})},this.Z=(P,t)=>this.h.then(y=>{const e=Float32Array.BYTES_PER_ELEMENT,s=y,n=(P.samplesDecoded*P.channelData.length*e+t.reduce((P,t)=>t.samplesDecoded*t.channelData.length*e+P,0)+t.length*(2*e))/65536+4,o=new WebAssembly.Memory({initial:n,A:n,Y:!0}),r=new Float32Array(o.buffer);let i=this.G(P.channelData,r,s);return Promise.all(t.map(t=>{const y=this.G(t.channelData,r,i),n=y+e,O=n+e,z=this.m(P,t),a=this.u(P,t),h=this.W("_syncWasmMemory",[o,y,n,s,P.samplesDecoded,P.channelData.length,i,t.samplesDecoded,t.channelData.length,z,a]);return i=O,h}))}),this.v=(P,t,y)=>{const e=[],s=[0],n=this.m(P,t),o=Math.log(P.samplesDecoded*n)/Math.log(this.t+1)*Math.log(n/1e4+1);y=Math.max(Math.round(Math.min(y,o,P.samplesDecoded/n/4)),1);const r=Math.ceil(P.samplesDecoded/y);let i=0;for(let O=0;O<y;O++){const y={channelData:[]};for(let t=0;t<P.channelData.length;t++){const e=P.channelData[t].subarray(i,i+r+n);y.channelData.push(e),y.samplesDecoded=e.length}i+=r-n,s.push(i),e.push(this._(y,t))}return Promise.all(e).then(P=>{let t=0,y=-1;for(let e=0;e<P.length;e++)P[e].correlation>y&&(t=e,y=P[e].correlation);return{correlation:P[t].correlation,sampleOffset:P[t].sampleOffset+s[t]}})},this.V=(P,t)=>this.W("_syncOneToMany",[P,t]),this._=(P,t)=>this.W("_sync",[P,t]),this.k=(P,t,y)=>globalThis.Worker?this.W("_syncWorkerConcurrent",[P,t,y]):this.v(P,t,y),this.M=new Map([["_sync",this.T],["_syncWasmMemory",this.U],["_syncOneToMany",this.Z],["_syncWorker",this._],["_syncWorkerConcurrent",this.v]]),this.O=y,this.h=e,this.P=s,this.t=n},this.S=new this.l(this.O,this.h,this.P,this.t)}async syncWorkerConcurrent(P,t,y){return this.S.k(P,t,y>=1?y:1)}async syncWorker(P,t){return this.S._(P,t)}async sync(P,t){return this.S.T(P,t)}async q(P,t){return this.S.V(P,t)}async X(P,t){return this.S.Z(P,t)}async syncMultiple(P,t){t=t>=1?t:8;const y=[],e=[];let s=()=>{},n=Promise.resolve(),o=0;const r=()=>{n=new Promise(P=>{s=P})};for(let f=0;f<P.length;f++)e.push({vertex:{}});for(let f=0;f<P.length;f++){const i=P[f],O=e[f].vertex;O.name=i.name,O.samplesDecoded=i.data.samplesDecoded,O.D=new Set;for(let z=0;z<P.length;z++){if(f===z)continue;const a=P[z],h=e[z];o++,y.push(this.syncWorker(i.data,a.data).then(P=>{P.correlation>this.o&&O.D.add({parent:O,vertex:h.vertex,samplesDecoded:a.data.samplesDecoded,...P}),o--,s()})),o>=t&&(r(),await n)}}await Promise.all(y);const i=(P,t)=>P.parent&&t.parent&&P.parent.samplesDecoded!==t.parent.samplesDecoded?P.parent.samplesDecoded>t.parent.samplesDecoded:P.correlation!==t.correlation?P.correlation>t.correlation:P.sampleOffset!==t.sampleOffset?P.sampleOffset>t.sampleOffset:P.vertex&&t.vertex&&P.vertex.name.localeCompare(t.vertex.name)<0,O=new Map,z=new Set,a=P=>{for(const t of P.D.values()){if(O.has(P))return O.get(P);O.set(P,t);const y=a(t.vertex),e=t;if(y){let P,t;i(y,e)?(P=y,t=e):(P=e,t=y),t.F||(t.F=new Set,z.add(t)),t.F.add(P),P.F&&P.F.delete(t)}O.delete(P)}};for(const{vertex:f}of e)a(f);for(const f of z)f.F.size&&f.parent.D.delete(f);const h=new Set;for(const f of e)h.add(f.vertex);for(const f of e)for(const P of f.vertex.D)h.delete(P.vertex);const c=(P,t,y,e=0)=>{for(const s of y)P.has(s.vertex)&&i(P.get(s.vertex),s)||P.set(s.vertex,{name:s.vertex.name,correlation:s.correlation,sampleOffset:e+s.sampleOffset}),c(P,t,s.vertex.D,e+s.sampleOffset)},l=[];for(const f of h){const P=new Map;P.set(f,{name:f.name,sampleOffset:0}),c(P,f,f.D),l.push([...P.values()].sort((P,t)=>P.sampleOffset-t.sampleOffset||(P.correlation||0)-(t.correlation||0)||t.name.localeCompare(P.name)))}return l}}return o},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@eshaz/web-worker")):"function"==typeof define&&define.amd?define(["@eshaz/web-worker"],t):(P="undefined"!=typeof globalThis?globalThis:P||self).SynAudio=t(P.Worker);
//# sourceMappingURL=synaudio.min.js.map