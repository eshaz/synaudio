/* Copyright 2022 Ethan Halsall. This file is part of synaudio. https://github.com/eshaz/synaudio */
var e,g;e=this,g=function(e){const g=(e,g=4294967295,b=79764919)=>{const f=new Int32Array(256);let r,t,o,i=g;for(r=0;r<256;r++){for(o=r<<24,t=8;t>0;--t)o=2147483648&o?o<<1^b:o<<1;f[r]=o}for(r=0;r<e.length;r++)i=i<<8^f[255&(i>>24^e[r])];return i},b=(e,b=g)=>{const f=e=>new Uint8Array(e.length/2).map((g,b)=>parseInt(e.substring(2*b,2*(b+1)),16)),r=e=>f(e)[0],t=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((e,g)=>t.set(e,g));const o=new Uint8Array(e.length);let i,s,h,p=!1,n=0,y=42,P=e.length>13&&"dynEncode"===e.substring(0,9),a=0;P&&(a=11,s=r(e.substring(9,a)),s<=1&&(a+=2,y=r(e.substring(11,a))),1===s&&(a+=8,h=(e=>new DataView(f(e).buffer).getInt32(0,!0))(e.substring(13,a))));const u=256-y;for(let g=a;g<e.length;g++)if(i=e.charCodeAt(g),61!==i||p){if(92===i&&g<e.length-5&&P){const b=e.charCodeAt(g+1);117!==b&&85!==b||(i=parseInt(e.substring(g+2,g+6),16),g+=5)}if(i>255){const e=t.get(i);e&&(i=e+127)}p&&(p=!1,i-=64),o[n++]=i<y&&i>0?i+u:i-y}else p=!0;const c=o.subarray(0,n);if(P&&1===s){const e=b(c);if(e!==h){const g="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",g+"\n","Expected: "+h+"; Got: "+e+"\n","Visit https://github.com/eshaz/simple-yenc for more information"),Error(g)}}return c},f=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),r=new WeakMap,t=String.raw`dynEncode01659c5b130beÆØÒfeeefsfÅoääääääääääegwfhÊÓÛkÒÊÒÔ×Þghgååihgfekmfäe¦åíiplgnÈÔ××ÊÑÆÙÊeepÄÄÍÊÆÕÄÇÆØÊheofitämâlàmág¥¦cdddl}©eeeeeeU¤©eeeeeeeepg¥g¥g¦g­reg¦fÐzf¦v³i¥ff¦vÐp¦ÕÖg¦vÏofo¯o¦hÖxgx×oÐ¦uÏsp¦iÛr¦kÙeÏqo¦gÙp¦gÙ¦¥ÖÐÏyf¦gÙ{r¦fÏuq¦¥ÐpogÐ¦uÐo¦l°|g¦uÏqoxÐÏvh¥egurh¥ggtÏobeeegbeeebIfbpeegobeeugbeeubIfbpeugobeegbeebIfbpegobeegbeebIfbpeg¦¥Ðgr¦fÐrrepg¥fq±reqog¥|ªrepyw{ÑgÏ®ygpÏ°Örepgsoh¥ggbegegtÏbegebIfbpgeg¦uÏgo¦iÏorepvoxªrfpo¦gÙeÏgh¥gggegtÏge÷geg¦iÏgfo¦fÏo¯reppt{Ïtw¦fÏwz¬repqfpf¦e±reeef¦gÙyÏ®iäefg¦gÙ¦iÐÑeÏ®j¦epf¦i®×{f¦hÖse¦Ïue¦Ïve¦uÏxf¦adddlÖqh¥¦epg¥{ªi¥eebegeefwÑ¦gÙgÏbegebIfbpgeg¥q¦i«rexxbegegxÏbegebIfbpgeq¦m«revvbegegvÏbegebIfbpgeq¦q«reuubegeguÏbegebIfbpgepfqp«rfpptsi¥psÏtp¦gÙeÏgsoh¥gggegrÏge÷geg¦iÏgo¦fÐorepppfÐ¦á°reftÐpt¦gÙeÏgh¥gggegrÏoge÷gegggiogi÷gigggmogm÷gmgggqogq÷gqg¦uÏgp¦iÐpreppryÏrw¦fÏwz¬reppg¥j¦g­rej¦fÐxi¦v³i¥ii¦vÐj¦ÕÖg¦vÏoio¯o¦hÖvgv×oÐ¦uÏqj¦iÛp¦kÙhÏro¦gÙj¦gÙ¦¥ÖÐÏzi¦gÙyp¦fÏsr¦¥Ðj¦etogÐ¦uÐo¦l°{g¦uÏpovÐÏu¦ewh¥hgsrh¥ggtÏobeeegbeeebIfbpeegobeeugbeeubIfbpeugobeegbeebIfbpegobeegbeebIfbpeg¦¥Ðgr¦fÐrrepg¥ip±repog¥{ªrejzwyÑgÏ®zgjÏ°Örejgqoh¥ggbegegtÏbegebIfbpgeg¦uÏgo¦iÏorepuovªrfpo¦gÙhÏgh¥gggegtÏge÷geg¦iÏgio¦fÏo¯repptyÏtw¦fÏwx¬repqfpi¦e±rehhi¦gÙzÏ®iähij¦gÙ¦iÐÑhÏ®j¦epi¦i®×yi¦hÖqh¦Ïsh¦Ïuh¦uÏvi¦adddlÖj¦er¦ewh¥¦epg¥yªi¥hhbegehiwÑ¦gÙgÏbegebIfbpgeg¥j¦i«revvbegegvÏbegebIfbpgej¦m«reuubegeguÏbegebIfbpgej¦q«ressbegegsÏbegebIfbpgepijp«rfpptqi¥pqÏtp¦gÙhÏgqoh¥gggegrÏge÷geg¦iÏgo¦fÐorepppiÐ¦á°reitÐpt¦gÙhÏgh¥gggegrÏoge÷gegggiogi÷gigggmogm÷gmgggqogq÷gqg¦uÏgp¦iÐprepprzÏrw¦fÏwx¬repp¦eqn¦egem¦egegäk¦e¯i¥g¥g¥g¥g¥k¦f«i¥¦erqfpegk}Öroh¥gbÂgebÄbUfg¦mÏgo¦gÐorepbrmnopqrstefghijklbUfbekr«rfpkrÐor¦gÙeÏgh¥gge g¦iÏgo¦fÐorepk¦f«i¥¦erqgpk}Örpbqeeeeeeeeeeeeeeeehgroh¥gbÂgebÄbUfg¦mÏgo¦gÐorepbrmnopqrstefghijklbUfbekr«rfpkrÐor¦gÙhÏgh¥gge g¦iÏgo¦fÐoreppk¦uÐik~k¦v­i¥bqeeeeeeeeeeeeeeee¦eqgp~bx¦eobqeeeeeeeeeeeeeeeehgh¥gbeeebJfbKfbIfgbeeubJfbKfbIfgbeebJfbKfbIfgbeebJfbKfbIfg¦¥Ðgio¦uÏo¯rep¦fqk¦vÐ¦ÕÖ¦uÏqfpk¦uÐik¦epjbebf÷bg÷bh÷g¥jk³rekkjÐp¦i´iäbqeeeeeeeeeeeeeeeebej¦gÙhÏg~bxp¦áÖroh¥gbegebJfbKfbIfg¦uÏgo¦iÐorepbrmnopqrstefghefghbIfbrijklefghefghefghbIfbepr«rfjrÏjjpjÐoj¦gÙhÏgh¥gge~øù÷g¦iÏgo¦fÐoreppk¨eeå$÷¦eoqi¥~bxhgh¥ggbeeebJfbpeeggbeeubJfbpeuggbeebJfbpeggbeebJfbpeg¦¥Ðgio¦uÏo¯reppúfkÐsg¥ko±rekkoÐf¦h°iäo¦gÙhÏg~bxf¦áÖjrh¥ggbegebJfbpgeg¦uÏgr¦iÐrrepfj«rfjoÏjopoÐro¦gÙhÏgh¥ggge~øgeg¦iÏgr¦fÐrreppös¦e¯i¥l¦gÙv¨eeå¤úk¦vÐ¦ÕÖ¦uÏrmge ¦efeph¥f¦gÙeÏwge~gäqªi¥bqeeeeeeeeeeeeeeeebqeeeeeeeeeeeeeeee¦eqfpbx¦eg¦etbqeeeeeeeeeeeeeeeebqeeeeeeeeeeeeeeeeh¥gpÏjbeeebJfghÏobeeebKfbIfjbeeubJfobeeubKfbIfjbeebJfobeebKfbIfjbeebJfobeebKfbIfbKfbIfbKfbIfbKfbIfbKfbIfg¦¥Ðgit¦uÏt¯reprpj~ bebf÷bg÷bh÷~bebf÷bg÷bh÷g¥jk³rekjÐt¦i´iäj¦gÙgbqeeeeeeeeeeeeeeeebebqeeeeeeeeeeeeeeee~bebxt¦áÖuoh¥gpÏbegebJfghÏbegebKfbIfg¦uÏgbKfbIfo¦iÐorepbrmnopqrstefghefghbIfbrijklefghefghefghbIfbebrmnopqrstefghefghbIfbrijklefghefghefghbIfbe~tu«rfjuÏjjpj¦gÙgkjÐoh¥gpÏgeøghÏgeù÷g¦iÏgù~÷~o¦fÐoreppk¦gÙwÏge ù ~ù ~Åªiânfgem~ge~jppvÏpflÏfs­reppg¥l¦f±rengefllÑgÏjsjs­l¦erfgÐf¦ef¦e¯tg¥k¦e±i¥qfpk¦f¬i¥t¦gÙeÏgbqeeeeeeeeeeeeeeeek}Öroh¥gbÂgebÄbUfg¦mÏgo¦gÐorepbrmnopqrstefghijklbUfbekr«rfpr¦gÙt¦gÙÏeÏgkrÐoh¥gge g¦iÏgo¦fÐorepplt±re¨eeå¤út¦gÙeÏpk¦vÐ¦ÕÖ¦uÏjmge h¥t¦gÙeÏuge~gäqªi¥bqeeeeeeeeeeeeeeeebqeeeeeeeeeeeeeeee¦eqfpbx¦erpghobqeeeeeeeeeeeeeeeebqeeeeeeeeeeeeeeeeh¥gbeeebJfobeeebKfbIfgbeeubJfobeeubKfbIfgbeebJfobeebKfbIfgbeebJfobeebKfbIfbKfbIfbKfbIfbKfbIfbKfbIfg¦¥Ðgo¦¥Ðoir¦uÏr¯repjpf~ bebf÷bg÷bh÷~bebf÷bg÷bh÷g¥fk³rekfÐr¦i´iäf¦gÙgbqeeeeeeeeeeeeeeeebebqeeeeeeeeeeeeeeee~bebxr¦áÖsoh¥gpÏbegebJfghÏbegebKfbIfg¦uÏgbKfbIfo¦iÐorepbrmnopqrstefghefghbIfbrijklefghefghefghbIfbebrmnopqrstefghefghbIfbrijklefghefghefghbIfbe~rs«rffsÏjfpf¦gÙgkfÐoh¥gpÏgeøghÏgeù÷g¦iÏgù~÷~o¦fÐoreppk¦gÙuÏge ù ~ù ~Åªiântgem~ge~jpp¦iÏpt¦fÏtl¬reppppe°tÙÆ×ÌÊÙÄËÊÆÙÚ×ÊØjlÆÙÔÒÎÈØtÒÚÙÆÇÑÊÌÑÔÇÆÑØlØÎÒÉpÇÚÑÐÒÊÒÔ×ÞmØÎÌÓÊÝÙ`,o=String.raw`dynEncode010fff699321p|,ooot}|t|~P*r~t{ptnnwtpnqptÿ ¡O/PW/Pz0/P]O/Pz0/P0/Py10O/0/0/0P0O//9//y19¡G//9/9¡G//9/9¡G//9/9¡G/1Py0/1Py0/Py0//Py1Y//YOO//9/9¡G/Py0/Py0//Py1Y//y0//y0/Py1/V/P[/P0/90/PU0/PU0/0O///9¡1GO///9/9¡G/PU//9/9¡G///9/9¡G//y0/Pz1O/1PWP/Pz0/Pz0O//y19/¢1//y19£/¡/9/¢1/9£¡/9/¢1/9£¡/9/¢1/9£¡0//£/¡//£¡//£¡//£¡0/Py0//Py1Y/PPy1/]//zP//P1y9/¢1//y9£/¡0//£/¡0/Py/0/Pz/U//z0//P1y0//y0O/9/¢1/£/9/¢1/£/¡¡0//9£//9£/¡¡0/Py0/Py0/Pz1//ÁRÎ¡1¤Ê//¤Ê®/Ê±²ÅàOP0SÿN0&S0'O///////PE/PE/PYO/P0/Pz1P^O/0//10O/!/9Ê¯/9Ê¯/9Ê¯/9Ê¯0!/Py0/Pz1/O/P/y0/0O/!/9Ê¯0!/Py0/Pz1/P^O/0//10O/"/9Ê¯/9Ê¯/9Ê¯/9Ê¯0"/Py0/Pz1/O/P/y0O/"/9Ê¯0"/Py0/Pz1/Pz0/Á0 /PWOP0P/"Å/ ¤0P0/0O/9/¢1/£/¡/9/¢1/£¡/9/¢1/£¡/9/¢1/£¡0/Py0/Py1/WP0/PzPPy/Pz0/Á0 P0/"/Æ1"²Å0O//]//zP1/P/y0/0O/9/¢1/£/¡0/Py0/Pz1//y/0//zPZ//z0/P/y0O/9/¢1/£/9/¢1/£/9/¢1/£/9/¢1/£/¡¡¡¡0/Py0/Pz1/ RÎ¡0 P0/O/0O//9/¢G//9/¢G//9/¢G//9/¢G/Py0/Py1/W// ¤0//z0O//]/0//zP1O//y0/P/y0O//9/¢G/Py0/Pz1//zPZ//z0/P/y0O//9/¢G//9/¢G//9/¢G//9/¢G/Py0/Pz1/ 0O/P[OP0/P0/P0/&/"²0#P0/0P0O/!/9Ê°0$//y9Ê0%/90///!/#±Å//1 /nT//E// G//0/$/%¯0!//y0//y1/WO/P[///{1y1///W*0P0//z1P/PY*0O/P[O/'0!/P0O/PzPXO/'0!/P/y0/'0!//10O/!/9Ê¯/9Ê¯/9Ê¯/9Ê¯0!/Py0/Pz1/T/P/Py/y0O/!/9Ê¯0!/Py0/Pz1//]/P0/&/"²0"/P/y0O/!/9Ê°0#//y9Ê0$/90///!/"±Å//1 /nTO//E// G/#/$¯0!/Py0/Py1/V;pvtnutpt:|pq{t<v{~qp{:xv}<t`;class i{constructor(g={}){this.t=g.correlationSampleSize>0?g.correlationSampleSize:11025,this.o=g.initialGranularity>0?g.initialGranularity:16,this.i=g.h>=0?g.h:.5,this.p=r.get(i),this.P=f().then(e=>66560),this.p||(this.p=f().then(e=>e?WebAssembly.compile(b(t)):WebAssembly.compile(b(o))),r.set(this.p)),this.u=function g(b,f,r,t){this.l=new Map,this.m=(e,g)=>Math.min(e.samplesDecoded,g.samplesDecoded,this.t),this.q=(e,g)=>Math.min(e.samplesDecoded,g.samplesDecoded,this.o),this.j=(e,g,b)=>{const f=g.BYTES_PER_ELEMENT;let r=b/f;for(let t=0;t<e.length;t++)b+=e[t].length*f,g.set(e[t],r),r+=e[t].length;return b},this.k=(b,f)=>{let r=this.l.get(b);if(!r){let e,f="text/javascript",t=`'use strict';(${""+((e,g,b,f)=>{self.onmessage=r=>{new e(Promise.resolve(r.data.module),Promise.resolve(r.data.O),b,f).I.get(g).apply(null,r.data.v).then(e=>{self.postMessage(e)})}})})(${""+g}, "${b}", ${this.t}, ${this.o})`;try{e=void 0!==process.versions.node}catch{}r=e?`data:${f};base64,${Buffer.from(t).toString("base64")}`:URL.createObjectURL(new Blob([t],{type:f})),this.l.set(b,r)}const t=new(globalThis.Worker||e)(r,{name:"SynAudio"}),o=new Promise(e=>{t.onmessage=g=>{t.terminate(),e(g.data)}});return Promise.all([this.p,this.P]).then(([e,g])=>{t.postMessage({module:e,O:g,v:f})}),o},this.K=(e,g,b,f,r,t,o,i,s,h,p)=>this.p.then(g=>WebAssembly.instantiate(g,{env:{memory:e}})).then(({exports:n})=>{const y=new Map(Object.entries(n)).get("correlate"),P=new DataView(e.buffer);return y(g,b,f,r,t,o,i,s,h,p),{correlation:P.getFloat32(h,!0),sampleOffset:P.getInt32(p,!0)}}),this.M=(e,g)=>this.P.then(b=>{const f=Float32Array.BYTES_PER_ELEMENT,r=(e.samplesDecoded*e.channelData.length*f+g.samplesDecoded*g.channelData.length*f+2*f+b)/65536+4,t=new WebAssembly.Memory({initial:r,W:r,G:!0}),o=new Float32Array(t.buffer),i=b,s=this.j(e.channelData,o,i),h=this.j(g.channelData,o,s),p=h+f,n=this.m(e,g),y=this.q(e,g);return this.K(t,i,e.samplesDecoded,e.channelData.length,s,g.samplesDecoded,g.channelData.length,n,y,h,p)}),this.J=(e,g)=>this.P.then(b=>{const f=Float32Array.BYTES_PER_ELEMENT,r=(e.samplesDecoded*e.channelData.length*f+g.reduce((e,g)=>g.samplesDecoded*g.channelData.length*f+e,0)+g.length*(2*f)+b)/65536+4,t=new WebAssembly.Memory({initial:r,W:r,G:!0}),o=new Float32Array(t.buffer),i=b;let s=this.j(e.channelData,o,i);return Promise.all(g.map(g=>{const b=this.j(g.channelData,o,s),r=b+f,h=r+f,p=this.m(e,g),n=this.q(e,g),y=this.k("_syncWasmMemory",[t,i,e.samplesDecoded,e.channelData.length,s,g.samplesDecoded,g.channelData.length,p,n,b,r]);return s=h,y}))}),this.A=(e,g,b)=>{const f=[],r=[0],t=this.m(e,g),o=Math.log(e.samplesDecoded*t)/Math.log(this.o+1)*Math.log(t/1e4+1);b=Math.max(Math.round(Math.min(b,o,e.samplesDecoded/t/4)),1);const i=Math.ceil(e.samplesDecoded/b);let s=0;for(let h=0;h<b;h++){const b={channelData:[]};for(let g=0;g<e.channelData.length;g++){const f=e.channelData[g].subarray(s,s+i+t);b.channelData.push(f),b.samplesDecoded=f.length}s+=i-t,r.push(s),f.push(this.U(b,g))}return Promise.all(f).then(e=>{let g=0,b=-1;for(let f=0;f<e.length;f++)e[f].correlation>b&&(g=f,b=e[f].correlation);return{correlation:e[g].correlation,sampleOffset:e[g].sampleOffset+r[g]}})},this.$=(e,g)=>this.k("_syncOneToMany",[e,g]),this.U=(e,g)=>this.k("_sync",[e,g]),this.T=(e,g,b)=>globalThis.Worker?this.k("_syncWorkerConcurrent",[e,g,b]):this.A(e,g,b),this.I=new Map([["_sync",this.M],["_syncWasmMemory",this.K],["_syncOneToMany",this.J],["_syncWorker",this.U],["_syncWorkerConcurrent",this.A]]),this.p=b,this.P=f,this.t=r,this.o=t},this.S=new this.u(this.p,this.P,this.t,this.o)}async syncWorkerConcurrent(e,g,b){return this.S.T(e,g,b>=1?b:1)}async syncWorker(e,g){return this.S.U(e,g)}async sync(e,g){return this.S.M(e,g)}async _(e,g){return this.S.$(e,g)}async Y(e,g){return this.S.J(e,g)}async syncMultiple(e,g){g=g>=1?g:8;const b=[],f=[];let r=()=>{},t=Promise.resolve(),o=0;const i=()=>{t=new Promise(e=>{r=e})};for(let u=0;u<e.length;u++)f.push({vertex:{}});for(let u=0;u<e.length;u++){const s=e[u],h=f[u].vertex;h.name=s.name,h.samplesDecoded=s.data.samplesDecoded,h.D=new Set;for(let p=0;p<e.length;p++){if(u===p)continue;const n=e[p],y=f[p];o++,b.push(this.syncWorker(s.data,n.data).then(e=>{e.correlation>this.i&&h.D.add({parent:h,vertex:y.vertex,samplesDecoded:n.data.samplesDecoded,...e}),o--,r()})),o>=g&&(i(),await t)}}await Promise.all(b);const s=(e,g)=>e.parent&&g.parent&&e.parent.samplesDecoded!==g.parent.samplesDecoded?e.parent.samplesDecoded>g.parent.samplesDecoded:e.correlation!==g.correlation?e.correlation>g.correlation:e.sampleOffset!==g.sampleOffset?e.sampleOffset>g.sampleOffset:e.vertex&&g.vertex&&e.vertex.name.localeCompare(g.vertex.name)<0,h=new Map,p=new Set,n=e=>{for(const g of e.D.values()){if(h.has(e))return h.get(e);h.set(e,g);const b=n(g.vertex),f=g;if(b){let e,g;s(b,f)?(e=b,g=f):(e=f,g=b),g.V||(g.V=new Set,p.add(g)),g.V.add(e),e.V&&e.V.delete(g)}h.delete(e)}};for(const{vertex:u}of f)n(u);for(const u of p)u.V.size&&u.parent.D.delete(u);const y=new Set;for(const u of f)y.add(u.vertex);for(const u of f)for(const e of u.vertex.D)y.delete(e.vertex);const P=(e,g,b,f=0)=>{for(const r of b)e.has(r.vertex)&&s(e.get(r.vertex),r)||e.set(r.vertex,{name:r.vertex.name,correlation:r.correlation,sampleOffset:f+r.sampleOffset}),P(e,g,r.vertex.D,f+r.sampleOffset)},a=[];for(const u of y){const e=new Map;e.set(u,{name:u.name,sampleOffset:0}),P(e,u,u.D),a.push([...e.values()].sort((e,g)=>e.sampleOffset-g.sampleOffset||(e.correlation||0)-(g.correlation||0)||g.name.localeCompare(e.name)))}return a}}return i},"object"==typeof exports&&"undefined"!=typeof module?module.exports=g(require("@eshaz/web-worker")):"function"==typeof define&&define.amd?define(["@eshaz/web-worker"],g):(e="undefined"!=typeof globalThis?globalThis:e||self).SynAudio=g(e.Worker);
//# sourceMappingURL=synaudio.min.js.map